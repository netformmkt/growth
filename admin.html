<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê·¸ë¡œìŠ¤ë³´ë“œ - Admin</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif; }
    button:hover { opacity: 0.9; }
    input:focus { border-color: #3182F6 !important; outline: none; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-thumb { background: #DDD; border-radius: 3px; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const firebaseConfig = {
      apiKey: "AIzaSyDIlXh7hkdymo_3XNnTHvDllrBO5jnJwsI",
      authDomain: "growthboard-netform.firebaseapp.com",
      databaseURL: "https://growthboard-netform-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "growthboard-netform",
      storageBucket: "growthboard-netform.firebasestorage.app",
      messagingSenderId: "489120165966",
      appId: "1:489120165966:web:914e01c04b3b900ff1131f"
    };

    let db = null;
    try { firebase.initializeApp(firebaseConfig); db = firebase.database(); } catch (e) {}

    const TEAMS_DATA = {
      "ëŒ€í‘œì´ì‚¬ì‹¤": ["ì´ìŠ¹ìš°"],
      "ê²½ì˜ê´€ë¦¬íŒ€": ["ì‹ ë‚˜ì˜", "ì£¼ìœ ì§„", "ê¹€ìœ ë¦¼"],
      "ê·¸ë¡œìŠ¤íŒ€": ["ì´ì¬í›ˆ"],
      "ì„œë¹„ìŠ¤ìš´ì˜1íŒ€": ["í•œì¤€ì—½", "ì¡°ì¬ì—°", "ì •ì •í›ˆ", "ê¹€ì„±ë¯¼", "í•œì§€í˜œ"],
      "ì„œë¹„ìŠ¤ìš´ì˜2íŒ€": ["ê¶Œì •ì•„", "ê¹€ìˆ˜ì§„"],
      "ì„œë¹„ìŠ¤ìš´ì˜3íŒ€": ["ì£¼í˜„ì§„", "ì†¡ë³´ëŒ"],
      "ê¸°ìˆ ì—°êµ¬ì†Œ": ["ì‹ ëª…í¬", "ì‹¬í˜œì§„", "ê¹€ì†Œì •"],
      "ì•„íŒŒíŠ¸ìŠ¤í€˜ì–´íŒ€": ["í•œì¸ê·œ"],
      "ì ì‚°íŒ€": ["ê¹€ì˜ì„±", "ì‹ ìˆ˜ì§„"],
      "ë¸Œëœë“œë§ˆì¼€íŒ…íŒ€": ["ê¶Œí˜œì˜", "í•¨ì§€ë¯¼", "ê¹€ë²”ì„", "ê¹€ì†Œë¼"],
      "ë¸Œëœë“œì»¤ë¨¸ìŠ¤íŒ€": ["ì´ë€"],
      "ë¯¸ë””ì–´ì»¤ë¨¸ìŠ¤íŒ€": ["ë°©í˜„ìˆ˜", "ê¹€ì†Œì—°", "ë‚¨ìœ¤ì •"],
      "í•´ì™¸ì‚¬ì—…íŒ€": ["ê¹€ì±„ì›", "ì©í‹°ë¦¬"],
      "ëª¨ì—¬ë¼ë”œíŒ€": ["ê¹€ì†¡í¬", "ì´ì±„ì€"]
    };

    const TEAM_COLORS = {
      "ëŒ€í‘œì´ì‚¬ì‹¤": "#191F28", "ê²½ì˜ê´€ë¦¬íŒ€": "#3182F6", "ê·¸ë¡œìŠ¤íŒ€": "#00C471",
      "ì„œë¹„ìŠ¤ìš´ì˜1íŒ€": "#9B59B6", "ì„œë¹„ìŠ¤ìš´ì˜2íŒ€": "#FF6B6B", "ì„œë¹„ìŠ¤ìš´ì˜3íŒ€": "#E67E22",
      "ê¸°ìˆ ì—°êµ¬ì†Œ": "#1ABC9C", "ì•„íŒŒíŠ¸ìŠ¤í€˜ì–´íŒ€": "#3498DB", "ì ì‚°íŒ€": "#E74C3C",
      "ë¸Œëœë“œë§ˆì¼€íŒ…íŒ€": "#F39C12", "ë¸Œëœë“œì»¤ë¨¸ìŠ¤íŒ€": "#8E44AD", "ë¯¸ë””ì–´ì»¤ë¨¸ìŠ¤íŒ€": "#16A085",
      "í•´ì™¸ì‚¬ì—…íŒ€": "#2980B9", "ëª¨ì—¬ë¼ë”œíŒ€": "#C0392B"
    };

    const REGULAR_TEAMS = Object.fromEntries(Object.entries(TEAMS_DATA).filter(([team]) => team !== "ëŒ€í‘œì´ì‚¬ì‹¤"));

    const getWeekInfo = (date = new Date()) => {
      const d = new Date(date);
      const dayOfWeek = d.getDay();
      const daysSinceMonday = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
      const monday = new Date(d);
      monday.setDate(d.getDate() - daysSinceMonday);
      const sunday = new Date(monday);
      sunday.setDate(monday.getDate() + 6);
      const weekId = monday.getFullYear() + '-' + String(monday.getMonth()+1).padStart(2,'0') + '-' + String(monday.getDate()).padStart(2,'0');
      const label = monday.getMonth() === sunday.getMonth() 
        ? (monday.getMonth()+1) + '/' + monday.getDate() + '~' + sunday.getDate()
        : (monday.getMonth()+1) + '/' + monday.getDate() + '~' + (sunday.getMonth()+1) + '/' + sunday.getDate();
      return { weekId, monday, sunday, label };
    };

    const generateEmptyUploadStatus = () => {
      const status = {};
      Object.entries(REGULAR_TEAMS).forEach(([team, members]) => {
        members.forEach(member => { status[member] = { team, weeks: {} }; });
      });
      return status;
    };

    function App() {
      const [isLoggedIn, setIsLoggedIn] = useState(() => localStorage.getItem('growthboard_admin_logged_in') === 'true');
      const [currentTab, setCurrentTab] = useState('dashboard');
      const [uploadStatus, setUploadStatus] = useState(generateEmptyUploadStatus());
      const [scores, setScores] = useState({});
      const [growthdayActive, setGrowthdayActive] = useState(false);
      const [growthdayQuarter, setGrowthdayQuarter] = useState('');
      const [isLoading, setIsLoading] = useState(true);
      const [selectedWeek, setSelectedWeek] = useState(getWeekInfo().weekId);
      const [toast, setToast] = useState(null);
      const [selectedTeamFilter, setSelectedTeamFilter] = useState('all');
      const [showMissingModal, setShowMissingModal] = useState(false);
      const [showGrowthdayModal, setShowGrowthdayModal] = useState(false);

      useEffect(() => {
        if (!db) { setIsLoading(false); return; }
        const uploadRef = db.ref('uploadStatus');
        uploadRef.on('value', (snapshot) => {
          const data = snapshot.val();
          if (data) {
            setUploadStatus(() => {
              const merged = generateEmptyUploadStatus();
              Object.keys(data).forEach(member => {
                if (merged[member]) merged[member].weeks = data[member].weeks || {};
              });
              return merged;
            });
          }
          setIsLoading(false);
        });
        const scoresRef = db.ref('scores');
        scoresRef.on('value', (snapshot) => { if (snapshot.val()) setScores(snapshot.val()); });
        const growthdayRef = db.ref('growthday');
        growthdayRef.on('value', (snapshot) => {
          const data = snapshot.val();
          if (data) { setGrowthdayActive(data.active || false); setGrowthdayQuarter(data.quarter || ''); }
        });
        return () => { uploadRef.off(); scoresRef.off(); growthdayRef.off(); };
      }, []);

      useEffect(() => { localStorage.setItem('growthboard_admin_logged_in', isLoggedIn.toString()); }, [isLoggedIn]);

      const showToast = (msg) => { setToast(msg); setTimeout(() => setToast(null), 2500); };

      const handleUploadToggle = (member, weekId) => {
        if (!db) { showToast('Firebase ì—°ê²° í•„ìš”'); return; }
        db.ref('uploadStatus/' + member + '/weeks/' + weekId).set(!(uploadStatus[member]?.weeks?.[weekId] || false));
        showToast(member + 'ë‹˜ì˜ ì—…ë¡œë“œ ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤');
      };

      const handleGrowthdayStart = (year, quarter) => {
        if (!db) { showToast('Firebase ì—°ê²° í•„ìš”'); return; }
        db.ref('growthday').set({ active: true, quarter: year + 'ë…„ ' + quarter + 'ë¶„ê¸°' });
        setShowGrowthdayModal(false);
        showToast(year + 'ë…„ ' + quarter + 'ë¶„ê¸° ê·¸ë¡œìŠ¤ë°ì´ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤');
      };

      const handleGrowthdayStop = () => {
        if (!db) { showToast('Firebase ì—°ê²° í•„ìš”'); return; }
        db.ref('growthday/active').set(false);
        showToast('ê·¸ë¡œìŠ¤ë°ì´ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤');
      };

      const handleScoreDelete = (presenter, voter) => {
        if (!db) { showToast('Firebase ì—°ê²° í•„ìš”'); return; }
        db.ref('scores/' + growthdayQuarter + '/' + presenter + '/' + voter).remove();
        showToast(voter + 'ë‹˜ì˜ ' + presenter + 'ë‹˜ì— ëŒ€í•œ ë°°ì ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
      };

      const getStats = () => {
        const totalMembers = Object.keys(uploadStatus).length;
        const currentWeekUploads = Object.values(uploadStatus).filter(s => s.weeks?.[selectedWeek]).length;
        const teamStats = {};
        Object.entries(REGULAR_TEAMS).forEach(([team, members]) => {
          const uploaded = members.filter(m => uploadStatus[m]?.weeks?.[selectedWeek]).length;
          teamStats[team] = { total: members.length, uploaded, rate: Math.round((uploaded / members.length) * 100) };
        });
        const missingMembers = [];
        Object.entries(uploadStatus).forEach(([name, data]) => {
          if (!data.weeks?.[selectedWeek]) missingMembers.push({ name, team: data.team });
        });
        return { totalMembers, currentWeekUploads, overallRate: Math.round((currentWeekUploads / totalMembers) * 100), teamStats, missingMembers };
      };

      const getGrowthdayStats = () => {
        const quarterScores = scores[growthdayQuarter] || {};
        const results = [];
        Object.entries(quarterScores).forEach(([presenter, voters]) => {
          const voterList = Object.entries(voters);
          if (voterList.length === 0) return;
          let totalScore = 0;
          const voterDetails = [];
          voterList.forEach(([voter, data]) => {
            const baseScore = Object.values(data.scores).reduce((a, b) => a + b, 0);
            const finalScore = data.isCEO ? baseScore * 2 : baseScore;
            totalScore += finalScore;
            const voterTeam = Object.entries(TEAMS_DATA).find(([t, members]) => members.includes(voter))?.[0] || '';
            voterDetails.push({ name: voter, team: voterTeam, baseScore, finalScore, isCEO: data.isCEO });
          });
          const averageScore = voterList.length > 0 ? totalScore / voterList.length : 0;
          const team = Object.entries(TEAMS_DATA).find(([t, members]) => members.includes(presenter))?.[0] || '';
          results.push({ name: presenter, team, voterCount: voterList.length, averageScore: averageScore.toFixed(1), ceoVoted: voterList.some(([, data]) => data.isCEO), voterDetails, totalScore });
        });
        return results.sort((a, b) => parseFloat(b.averageScore) - parseFloat(a.averageScore));
      };

      const stats = getStats();
      const growthdayStats = getGrowthdayStats();

      if (isLoading) return <div style={{minHeight:'100vh',display:'flex',alignItems:'center',justifyContent:'center',backgroundColor:'#F7F8FA'}}><div style={{textAlign:'center'}}><div style={{fontSize:'24px',marginBottom:'12px'}}>â³</div><div style={{color:'#666'}}>ë¡œë”© ì¤‘...</div></div></div>;
      if (!isLoggedIn) return <AdminLoginScreen onLogin={() => setIsLoggedIn(true)} />;

      return (
        <div style={styles.container}>
          {toast && <div style={styles.toast}>âœ“ {toast}</div>}
          {showMissingModal && <MissingModal stats={stats} selectedWeek={selectedWeek} onClose={() => setShowMissingModal(false)} onToggle={handleUploadToggle} />}
          {showGrowthdayModal && <GrowthdayStartModal onClose={() => setShowGrowthdayModal(false)} onStart={handleGrowthdayStart} />}
          <header style={styles.header}>
            <div style={styles.headerContent}>
              <div style={styles.logo}><span style={styles.logoText}>ê·¸ë¡œìŠ¤ë³´ë“œ</span><span style={styles.adminBadge}>Admin</span></div>
              <nav style={styles.nav}>
                <button style={{...styles.navButton, ...(currentTab === 'dashboard' ? styles.navButtonActive : {})}} onClick={() => setCurrentTab('dashboard')}>ëŒ€ì‹œë³´ë“œ</button>
                <button style={{...styles.navButton, ...(currentTab === 'members' ? styles.navButtonActive : {})}} onClick={() => setCurrentTab('members')}>ì¸ì› ê´€ë¦¬</button>
                <button style={{...styles.navButton, ...(currentTab === 'growthday' ? styles.navButtonActive : {})}} onClick={() => setCurrentTab('growthday')}>ê·¸ë¡œìŠ¤ë°ì´ ê´€ë¦¬</button>
              </nav>
              <button style={styles.logoutBtn} onClick={() => setIsLoggedIn(false)}>ë¡œê·¸ì•„ì›ƒ</button>
            </div>
          </header>
          <main style={styles.main}>
            {currentTab === 'dashboard' && <DashboardTab stats={stats} selectedWeek={selectedWeek} setSelectedWeek={setSelectedWeek} growthdayActive={growthdayActive} growthdayQuarter={growthdayQuarter} onMissingClick={() => setShowMissingModal(true)} uploadStatus={uploadStatus} />}
            {currentTab === 'members' && <MembersTab uploadStatus={uploadStatus} stats={stats} selectedWeek={selectedWeek} setSelectedWeek={setSelectedWeek} onToggle={handleUploadToggle} selectedTeamFilter={selectedTeamFilter} setSelectedTeamFilter={setSelectedTeamFilter} />}
            {currentTab === 'growthday' && <GrowthdayTab growthdayActive={growthdayActive} growthdayQuarter={growthdayQuarter} growthdayStats={growthdayStats} onStartClick={() => setShowGrowthdayModal(true)} onStop={handleGrowthdayStop} onScoreDelete={handleScoreDelete} />}
          </main>
        </div>
      );
    }

    function AdminLoginScreen({ onLogin }) {
      const [id, setId] = useState('');
      const [pw, setPw] = useState('');
      const [error, setError] = useState('');
      const handleLogin = () => { if (id === 'admin' && pw === 'admin') onLogin(); else setError('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤'); };
      return (
        <div style={styles.loginScreen}>
          <div style={styles.loginCard}>
            <div style={styles.loginHeader}><h1 style={styles.loginTitle}>ê·¸ë¡œìŠ¤ë³´ë“œ Admin</h1><p style={styles.loginSubtitle}>ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”</p></div>
            <div style={styles.inputGroup}><label style={styles.inputLabel}>ì•„ì´ë””</label><input type="text" value={id} onChange={e => { setId(e.target.value); setError(''); }} onKeyPress={e => e.key === 'Enter' && handleLogin()} style={styles.input} placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”" /></div>
            <div style={styles.inputGroup}><label style={styles.inputLabel}>ë¹„ë°€ë²ˆí˜¸</label><input type="password" value={pw} onChange={e => { setPw(e.target.value); setError(''); }} onKeyPress={e => e.key === 'Enter' && handleLogin()} style={styles.input} placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" /></div>
            {error && <div style={styles.errorText}>{error}</div>}
            <button style={styles.loginBtn} onClick={handleLogin}>ë¡œê·¸ì¸</button>
          </div>
        </div>
      );
    }

    function MissingModal({ stats, selectedWeek, onClose, onToggle }) {
      const [year, month, day] = selectedWeek.split('-').map(Number);
      const monday = new Date(year, month - 1, day);
      const sunday = new Date(monday); sunday.setDate(monday.getDate() + 6);
      const label = (monday.getMonth()+1) + '/' + monday.getDate() + '~' + (sunday.getMonth()+1) + '/' + sunday.getDate();
      return (
        <div style={styles.modalOverlay} onClick={onClose}>
          <div style={styles.modal} onClick={e => e.stopPropagation()}>
            <div style={styles.modalHeader}><h3 style={styles.modalTitle}>ë¯¸ì—…ë¡œë“œ ì¸ì› <span style={styles.modalCount}>{stats.missingMembers.length}ëª…</span></h3><button style={styles.modalClose} onClick={onClose}>âœ•</button></div>
            <div style={styles.modalSubtitle}>{label} ê¸°ì¤€</div>
            <div style={styles.missingList}>
              {stats.missingMembers.length === 0 ? <div style={styles.emptyMissing}>âœ“ ëª¨ë“  ì¸ì›ì´ ì—…ë¡œë“œë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!</div> :
                Object.entries(REGULAR_TEAMS).map(([team]) => {
                  const missingInTeam = stats.missingMembers.filter(m => m.team === team);
                  if (missingInTeam.length === 0) return null;
                  return (
                    <div key={team} style={styles.missingTeamGroup}>
                      <div style={styles.missingTeamHeader}><div style={{...styles.teamDot, backgroundColor: TEAM_COLORS[team]}} /><span>{team}</span><span style={styles.missingTeamCount}>{missingInTeam.length}ëª…</span></div>
                      <div style={styles.missingMembers}>{missingInTeam.map(member => <div key={member.name} style={styles.missingMember}><span>{member.name}</span><button style={styles.quickCheckBtn} onClick={() => onToggle(member.name, selectedWeek)}>ì™„ë£Œ ì²˜ë¦¬</button></div>)}</div>
                    </div>
                  );
                })}
            </div>
          </div>
        </div>
      );
    }

    function GrowthdayStartModal({ onClose, onStart }) {
      const currentYear = new Date().getFullYear();
      const [year, setYear] = useState(currentYear);
      const [quarter, setQuarter] = useState(Math.ceil((new Date().getMonth() + 1) / 3));
      return (
        <div style={styles.modalOverlay} onClick={onClose}>
          <div style={styles.modal} onClick={e => e.stopPropagation()}>
            <div style={styles.modalHeader}><h3 style={styles.modalTitle}>ê·¸ë¡œìŠ¤ë°ì´ ì‹œì‘</h3><button style={styles.modalClose} onClick={onClose}>âœ•</button></div>
            <div style={styles.modalSubtitle}>ë°°ì ì„ ì§„í–‰í•  ë¶„ê¸°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
            <div style={styles.selectGroup}><label style={styles.selectLabel}>ì—°ë„</label><div style={styles.selectButtons}>{[currentYear, currentYear+1, currentYear+2, currentYear+3].map(y => <button key={y} style={{...styles.selectBtn, ...(year === y ? styles.selectBtnActive : {})}} onClick={() => setYear(y)}>{y}ë…„</button>)}</div></div>
            <div style={styles.selectGroup}><label style={styles.selectLabel}>ë¶„ê¸°</label><div style={styles.selectButtons}>{[1,2,3,4].map(q => <button key={q} style={{...styles.selectBtn, ...(quarter === q ? styles.selectBtnActive : {})}} onClick={() => setQuarter(q)}>{q}ë¶„ê¸°</button>)}</div></div>
            <div style={styles.previewBanner}>ğŸ“Œ <strong>{year}ë…„ {quarter}ë¶„ê¸°</strong> ê·¸ë¡œìŠ¤ë°ì´ê°€ ì‹œì‘ë©ë‹ˆë‹¤</div>
            <div style={styles.modalActions}><button style={styles.cancelBtn} onClick={onClose}>ì·¨ì†Œ</button><button style={styles.confirmBtn} onClick={() => onStart(year, quarter)}>ì‹œì‘í•˜ê¸°</button></div>
          </div>
        </div>
      );
    }

    function WeekCalendar({ selectedWeek, setSelectedWeek, uploadStatus }) {
      const [currentMonth, setCurrentMonth] = useState(() => new Date(new Date().getFullYear(), new Date().getMonth(), 1));

      const getDaysInMonth = (date) => {
        const year = date.getFullYear();
        const month = date.getMonth();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const days = [];
        let startDay = firstDay.getDay();
        startDay = startDay === 0 ? 6 : startDay - 1;
        for (let i = 0; i < startDay; i++) {
          const prevDate = new Date(year, month, -startDay + i + 1);
          days.push({ date: prevDate, isCurrentMonth: false });
        }
        for (let i = 1; i <= lastDay.getDate(); i++) {
          days.push({ date: new Date(year, month, i), isCurrentMonth: true });
        }
        const remainingDays = 7 - (days.length % 7);
        if (remainingDays < 7) {
          for (let i = 1; i <= remainingDays; i++) {
            days.push({ date: new Date(year, month + 1, i), isCurrentMonth: false });
          }
        }
        return days;
      };

      const getWeekIdFromDate = (date) => {
        const d = new Date(date);
        const dayOfWeek = d.getDay();
        const daysSinceMonday = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
        const monday = new Date(d);
        monday.setDate(d.getDate() - daysSinceMonday);
        return monday.getFullYear() + '-' + String(monday.getMonth()+1).padStart(2,'0') + '-' + String(monday.getDate()).padStart(2,'0');
      };

      const getWeekUploadRate = (weekId) => {
        const totalMembers = Object.keys(uploadStatus).length;
        if (totalMembers === 0) return 0;
        const uploaded = Object.values(uploadStatus).filter(s => s.weeks?.[weekId]).length;
        return Math.round((uploaded / totalMembers) * 100);
      };

      const days = getDaysInMonth(currentMonth);
      const weeks = [];
      for (let i = 0; i < days.length; i += 7) weeks.push(days.slice(i, i + 7));

      const prevMonth = () => setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1, 1));
      const nextMonth = () => setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 1));
      const goToToday = () => {
        const today = new Date();
        setCurrentMonth(new Date(today.getFullYear(), today.getMonth(), 1));
        setSelectedWeek(getWeekIdFromDate(today));
      };

      const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
      const dayNames = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];

      return (
        <div style={styles.calendarContainer}>
          <div style={styles.calendarHeader}>
            <button style={styles.calendarNavBtn} onClick={prevMonth}>â—€</button>
            <span style={styles.calendarTitle}>{currentMonth.getFullYear()}ë…„ {monthNames[currentMonth.getMonth()]}</span>
            <button style={styles.calendarNavBtn} onClick={nextMonth}>â–¶</button>
            <button style={styles.todayBtn} onClick={goToToday}>ì˜¤ëŠ˜</button>
          </div>
          <div style={styles.calendarDayNames}>{dayNames.map(day => <div key={day} style={styles.calendarDayName}>{day}</div>)}<div style={styles.calendarDayName}>ì§„í–‰ë¥ </div></div>
          <div style={styles.calendarBody}>
            {weeks.map((week, weekIndex) => {
              const weekId = getWeekIdFromDate(week[0].date);
              const isSelected = weekId === selectedWeek;
              const uploadRate = getWeekUploadRate(weekId);
              return (
                <div key={weekIndex} style={{...styles.calendarWeekRow, ...(isSelected ? styles.calendarWeekRowSelected : {}), cursor: 'pointer'}} onClick={() => setSelectedWeek(weekId)}>
                  {week.map((dayObj, dayIndex) => {
                    const isToday = dayObj.date.toDateString() === new Date().toDateString();
                    return (
                      <div key={dayIndex} style={{...styles.calendarDay, ...(dayObj.isCurrentMonth ? {} : styles.calendarDayOtherMonth), ...(isToday ? styles.calendarDayToday : {}), ...(dayIndex >= 5 ? styles.calendarDayWeekend : {})}}>
                        {dayObj.date.getDate()}
                      </div>
                    );
                  })}
                  <div style={{...styles.weekUploadRate, color: uploadRate === 100 ? '#00C471' : uploadRate > 0 ? '#3182F6' : '#CCC'}}>{uploadRate}%</div>
                </div>
              );
            })}
          </div>
          <div style={styles.calendarLegend}>
            <span style={styles.legendItem}><span style={{...styles.legendDot, backgroundColor: '#00C471'}}></span> ì™„ë£Œ</span>
            <span style={styles.legendItem}><span style={{...styles.legendDot, backgroundColor: '#3182F6'}}></span> ì§„í–‰ì¤‘</span>
            <span style={styles.legendItem}><span style={{...styles.legendDot, backgroundColor: '#CCC'}}></span> ë¯¸ì‹œì‘</span>
          </div>
        </div>
      );
    }

    function DashboardTab({ stats, selectedWeek, setSelectedWeek, growthdayActive, growthdayQuarter, onMissingClick, uploadStatus }) {
      const [year, month, day] = selectedWeek.split('-').map(Number);
      const monday = new Date(year, month - 1, day);
      const sunday = new Date(monday); sunday.setDate(monday.getDate() + 6);
      const selectedWeekLabel = (monday.getMonth()+1) + '/' + monday.getDate() + '~' + (sunday.getMonth()+1) + '/' + sunday.getDate();

      return (
        <div style={styles.page}>
          <div style={styles.pageHeader}><h1 style={styles.pageTitle}>ëŒ€ì‹œë³´ë“œ</h1><p style={styles.pageSubtitle}>ê·¸ë¡œìŠ¤ë³´ë“œ ì—…ë¡œë“œ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p></div>
          <WeekCalendar selectedWeek={selectedWeek} setSelectedWeek={setSelectedWeek} uploadStatus={uploadStatus} />
          <div style={styles.selectedWeekBanner}>ğŸ“… ì„ íƒëœ ì£¼: <strong>{selectedWeekLabel}</strong></div>
          <div style={styles.summaryGrid}>
            <div style={styles.summaryCard}><div style={styles.summaryValue}>{stats.totalMembers}</div><div style={styles.summaryLabel}>ì´ ì¸ì›</div></div>
            <div style={styles.summaryCard}><div style={{...styles.summaryValue, color: '#00C471'}}>{stats.currentWeekUploads}</div><div style={styles.summaryLabel}>ì—…ë¡œë“œ ì™„ë£Œ</div></div>
            <div style={{...styles.summaryCard, cursor: 'pointer'}} onClick={onMissingClick}><div style={{...styles.summaryValue, color: '#E54545'}}>{stats.totalMembers - stats.currentWeekUploads}</div><div style={styles.summaryLabel}>ë¯¸ì—…ë¡œë“œ</div><div style={styles.clickHint}>í´ë¦­í•˜ì—¬ ìƒì„¸ë³´ê¸° â†’</div></div>
            <div style={styles.summaryCard}><div style={{...styles.summaryValue, color: growthdayActive ? '#00C471' : '#999', fontSize: '20px'}}>{growthdayActive ? growthdayQuarter : 'OFF'}</div><div style={styles.summaryLabel}>ê·¸ë¡œìŠ¤ë°ì´</div></div>
          </div>
          <div style={styles.progressSection}><div style={styles.progressHeader}><span>ì „ì²´ ì§„í–‰ë¥ </span><span style={styles.progressPercent}>{stats.overallRate}%</span></div><div style={styles.progressBarBg}><div style={{...styles.progressBarFill, width: stats.overallRate + '%'}} /></div></div>
          <div style={styles.teamSection}><h3 style={styles.sectionTitle}>ë¶€ì„œë³„ í˜„í™©</h3><div style={styles.teamGrid}>{Object.entries(stats.teamStats).map(([team, data]) => <div key={team} style={styles.teamCard}><div style={styles.teamHeader}><div style={{...styles.teamDot, backgroundColor: TEAM_COLORS[team]}} /><span style={styles.teamName}>{team}</span></div><div style={styles.teamStatsRow}><span style={styles.teamUploaded}>{data.uploaded}</span><span style={styles.teamTotal}>/ {data.total}</span></div><div style={styles.teamProgressBg}><div style={{...styles.teamProgressFill, width: data.rate + '%', backgroundColor: TEAM_COLORS[team]}} /></div><div style={styles.teamRate}>{data.rate}%</div></div>)}</div></div>
        </div>
      );
    }

    function MembersTab({ uploadStatus, stats, selectedWeek, setSelectedWeek, onToggle, selectedTeamFilter, setSelectedTeamFilter }) {
      const [year, month, day] = selectedWeek.split('-').map(Number);
      const monday = new Date(year, month - 1, day);
      const sunday = new Date(monday); sunday.setDate(monday.getDate() + 6);
      const selectedWeekLabel = (monday.getMonth()+1) + '/' + monday.getDate() + '~' + (sunday.getMonth()+1) + '/' + sunday.getDate();

      return (
        <div style={styles.page}>
          <div style={styles.pageHeader}><h1 style={styles.pageTitle}>ì¸ì› ê´€ë¦¬</h1><p style={styles.pageSubtitle}>ì§ì›ë“¤ì˜ ì—…ë¡œë“œ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ì„¸ìš”</p></div>
          <div style={styles.controlsRow}>
            <WeekCalendar selectedWeek={selectedWeek} setSelectedWeek={setSelectedWeek} uploadStatus={uploadStatus} />
            <select value={selectedTeamFilter} onChange={e => setSelectedTeamFilter(e.target.value)} style={styles.teamFilter}><option value="all">ì „ì²´ ë¶€ì„œ</option>{Object.keys(REGULAR_TEAMS).map(team => <option key={team} value={team}>{team}</option>)}</select>
          </div>
          <div style={styles.selectedWeekBanner}>ğŸ“… ì„ íƒëœ ì£¼: <strong>{selectedWeekLabel}</strong></div>
          <div style={styles.memberSection}>
            {Object.entries(REGULAR_TEAMS).filter(([team]) => selectedTeamFilter === 'all' || team === selectedTeamFilter).map(([team, members]) => (
              <div key={team} style={styles.memberTeamGroup}>
                <div style={styles.memberTeamHeader}><div style={{...styles.teamDot, backgroundColor: TEAM_COLORS[team]}} /><span>{team}</span><span style={styles.memberTeamCount}>{stats.teamStats[team]?.uploaded || 0}/{stats.teamStats[team]?.total || 0}</span></div>
                <div style={styles.memberList}>{members.map(member => { const isUploaded = uploadStatus[member]?.weeks?.[selectedWeek]; return <div key={member} style={styles.memberItem}><span style={styles.memberName}>{member}</span><button style={{...styles.memberToggle, backgroundColor: isUploaded ? '#E8F3FF' : '#FEF1F1', color: isUploaded ? '#3182F6' : '#E54545', borderColor: isUploaded ? '#3182F6' : '#E54545'}} onClick={() => onToggle(member, selectedWeek)}>{isUploaded ? 'âœ“ ì™„ë£Œ' : 'âœ• ë¯¸ì™„ë£Œ'}</button></div>; })}</div>
              </div>
            ))}
          </div>
        </div>
      );
    }

    function GrowthdayTab({ growthdayActive, growthdayQuarter, growthdayStats, onStartClick, onStop, onScoreDelete }) {
      const [selectedPresenter, setSelectedPresenter] = useState(null);
      const [isExporting, setIsExporting] = useState(false);
      const [deleteConfirm, setDeleteConfirm] = useState(null); // { presenter, voter, voterName }
      const selectedData = growthdayStats.find(r => r.name === selectedPresenter);

      const exportToPDF = async () => {
        setIsExporting(true);
        
        // PDFìš© ì„ì‹œ DOM ìš”ì†Œ ìƒì„±
        const pdfContent = document.createElement('div');
        pdfContent.style.cssText = 'position: absolute; left: -9999px; top: 0; width: 800px; padding: 40px; background: white; font-family: Pretendard, sans-serif;';
        
        const today = new Date();
        const dateStr = today.getFullYear() + '-' + String(today.getMonth()+1).padStart(2,'0') + '-' + String(today.getDate()).padStart(2,'0');
        
        pdfContent.innerHTML = `
          <div style="text-align: center; margin-bottom: 30px;">
            <h1 style="font-size: 28px; font-weight: 700; color: #191F28; margin-bottom: 8px;">ê·¸ë¡œìŠ¤ë°ì´ ì ìˆ˜ ë¦¬í¬íŠ¸</h1>
            <div style="font-size: 18px; color: #3182F6; font-weight: 600; margin-bottom: 4px;">${growthdayQuarter}</div>
            <div style="font-size: 12px; color: #999;">ìƒì„±ì¼: ${dateStr}</div>
          </div>
          <div style="border-top: 2px solid #E5E5E5; padding-top: 20px; margin-bottom: 20px;">
            <div style="font-size: 14px; color: #333; margin-bottom: 15px;">ì´ ë°œí‘œì: <strong>${growthdayStats.length}ëª…</strong></div>
          </div>
          <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
            <thead>
              <tr style="background: #F7F8FA;">
                <th style="padding: 12px 8px; text-align: center; color: #666; font-weight: 600; width: 60px;">ìˆœìœ„</th>
                <th style="padding: 12px 8px; text-align: left; color: #666; font-weight: 600;">ì´ë¦„</th>
                <th style="padding: 12px 8px; text-align: left; color: #666; font-weight: 600;">ì†Œì†</th>
                <th style="padding: 12px 8px; text-align: center; color: #666; font-weight: 600; width: 80px;">í‰ê°€ì¸ì›</th>
                <th style="padding: 12px 8px; text-align: center; color: #666; font-weight: 600; width: 80px;">í‰ê· ì ìˆ˜</th>
              </tr>
            </thead>
            <tbody>
              ${growthdayStats.map((result, index) => {
                const rankStyle = index === 0 ? 'background: #FFD700; color: white;' 
                  : index === 1 ? 'background: #C0C0C0; color: white;' 
                  : index === 2 ? 'background: #CD7F32; color: white;' : 'background: #F4F4F4; color: #666;';
                return `
                  <tr style="border-bottom: 1px solid #F4F4F4;">
                    <td style="padding: 14px 8px; text-align: center;">
                      <span style="display: inline-block; width: 28px; height: 28px; line-height: 28px; border-radius: 50%; font-weight: 700; font-size: 12px; ${rankStyle}">${index + 1}</span>
                    </td>
                    <td style="padding: 14px 8px; font-weight: 600; color: #191F28;">${result.name}</td>
                    <td style="padding: 14px 8px; color: #666;">${result.team}</td>
                    <td style="padding: 14px 8px; text-align: center; color: #666;">${result.voterCount}ëª… ${result.ceoVoted ? 'â­' : ''}</td>
                    <td style="padding: 14px 8px; text-align: center; font-weight: 700; color: #3182F6; font-size: 16px;">${result.averageScore}</td>
                  </tr>
                `;
              }).join('')}
            </tbody>
          </table>
          <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #E5E5E5;">
            <div style="font-size: 11px; color: #999;">â­ ëŒ€í‘œì´ì‚¬ í‰ê°€ (x2 ë°°ì  ì ìš©)</div>
            <div style="font-size: 11px; color: #999; margin-top: 4px;">Netform Growth Board</div>
          </div>
        `;
        
        document.body.appendChild(pdfContent);
        
        try {
          const canvas = await html2canvas(pdfContent, { scale: 2, useCORS: true });
          const imgData = canvas.toDataURL('image/png');
          
          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const pdfWidth = pdf.internal.pageSize.getWidth();
          const pdfHeight = pdf.internal.pageSize.getHeight();
          const imgWidth = pdfWidth - 20;
          const imgHeight = (canvas.height * imgWidth) / canvas.width;
          
          let heightLeft = imgHeight;
          let position = 10;
          
          pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
          heightLeft -= (pdfHeight - 20);
          
          while (heightLeft > 0) {
            position = heightLeft - imgHeight + 10;
            pdf.addPage();
            pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
            heightLeft -= (pdfHeight - 20);
          }
          
          const fileName = 'ê·¸ë¡œìŠ¤ë°ì´_' + growthdayQuarter.replace(/\s/g, '_') + '_' + dateStr + '.pdf';
          pdf.save(fileName);
        } catch (err) {
          console.error('PDF ìƒì„± ì˜¤ë¥˜:', err);
          alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        } finally {
          document.body.removeChild(pdfContent);
          setIsExporting(false);
        }
      };

      return (
        <div style={styles.page}>
          <div style={styles.pageHeader}><h1 style={styles.pageTitle}>ê·¸ë¡œìŠ¤ë°ì´ ê´€ë¦¬</h1><p style={styles.pageSubtitle}>ê·¸ë¡œìŠ¤ë°ì´ í™œì„±í™” ë° ì ìˆ˜ í˜„í™©ì„ ê´€ë¦¬í•˜ì„¸ìš”</p></div>
          <div style={styles.growthdayControlCard}>
            <div style={styles.growthdayControlHeader}><div><div style={styles.growthdayControlTitle}>ê·¸ë¡œìŠ¤ë°ì´ ë°°ì </div><div style={styles.growthdayControlDesc}>{growthdayActive ? growthdayQuarter + ' ë°°ì ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤' : 'ìƒˆë¡œìš´ ê·¸ë¡œìŠ¤ë°ì´ë¥¼ ì‹œì‘í•˜ì„¸ìš”'}</div></div>{growthdayActive ? <button style={styles.stopBtn} onClick={onStop}>ì¢…ë£Œí•˜ê¸°</button> : <button style={styles.startBtn} onClick={onStartClick}>ì‹œì‘í•˜ê¸°</button>}</div>
            <div style={{...styles.statusBanner, backgroundColor: growthdayActive ? '#E8FFF3' : '#F4F4F4', color: growthdayActive ? '#00C471' : '#666'}}><div style={{...styles.statusDot, backgroundColor: growthdayActive ? '#00C471' : '#999'}} />{growthdayActive ? growthdayQuarter + ' ê·¸ë¡œìŠ¤ë°ì´ ë°°ì ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤' : 'ê·¸ë¡œìŠ¤ë°ì´ ë°°ì ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤'}</div>
          </div>
          <div style={styles.scoreInfoCard}>â­ ëŒ€í‘œì´ì‚¬ë‹˜ì˜ ë°°ì ì€ <strong>2ë°°</strong>ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤ (ìµœëŒ€ 200ì )</div>
          {growthdayActive && (
            <div style={styles.scoresSection}>
              <div style={styles.scoresSectionHeader}>
                <h3 style={styles.sectionTitle}>{growthdayQuarter} ì ìˆ˜ í˜„í™© <span style={styles.scoreCount}>{growthdayStats.length}ëª… ë°œí‘œ</span></h3>
                {growthdayStats.length > 0 && <button style={{...styles.pdfExportBtn, opacity: isExporting ? 0.6 : 1}} onClick={exportToPDF} disabled={isExporting}>{isExporting ? 'â³ ìƒì„± ì¤‘...' : 'ğŸ“„ PDF ë‚´ë³´ë‚´ê¸°'}</button>}
              </div>
              {growthdayStats.length === 0 ? <div style={styles.emptyState}>ì•„ì§ ë°°ì ëœ ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤</div> :
                <div style={styles.scoresList}>
                  {growthdayStats.map((result, index) => (
                    <div key={result.name} style={styles.scoreCard} onClick={() => setSelectedPresenter(result.name)}>
                      <div style={styles.scoreRank}>{index < 3 ? <div style={{...styles.rankBadge, backgroundColor: index === 0 ? '#FFD700' : index === 1 ? '#C0C0C0' : '#CD7F32'}}>{index + 1}</div> : <span style={styles.rankNumber}>{index + 1}</span>}</div>
                      <div style={{...styles.scoreAvatar, backgroundColor: TEAM_COLORS[result.team]}}>{result.name[0]}</div>
                      <div style={styles.scoreInfo}><div style={styles.scoreName}>{result.name}</div><div style={styles.scoreTeam}>{result.team}</div></div>
                      <div style={styles.scoreVoters}>{result.voterCount}ëª… í‰ê°€ {result.ceoVoted && 'â­'}</div>
                      <div style={styles.scoreTotalValue}><span style={styles.scoreNumber}>{result.averageScore}</span><span style={styles.scoreUnit}>ì </span></div>
                      <span style={styles.detailArrow}>â†’</span>
                    </div>
                  ))}
                </div>}
            </div>
          )}
          {selectedPresenter && selectedData && (
            <div style={styles.modalOverlay} onClick={() => setSelectedPresenter(null)}>
              <div style={styles.modal} onClick={e => e.stopPropagation()}>
                <div style={styles.modalHeader}><h3 style={styles.modalTitle}><div style={{...styles.modalAvatar, backgroundColor: TEAM_COLORS[selectedData.team]}}>{selectedData.name[0]}</div>{selectedData.name} ì ìˆ˜ ìƒì„¸</h3><button style={styles.modalClose} onClick={() => setSelectedPresenter(null)}>âœ•</button></div>
                <div style={styles.modalSubtitle}>{selectedData.team} Â· í‰ê·  {selectedData.averageScore}ì </div>
                <div style={styles.voterList}>
                  {selectedData.voterDetails.map(voter => (
                    <div key={voter.name} style={styles.voterItem}>
                      <div style={styles.voterInfo}><div style={{...styles.voterAvatar, backgroundColor: TEAM_COLORS[voter.team]}}>{voter.name[0]}</div><div><div style={styles.voterName}>{voter.name}{voter.isCEO && <span style={styles.ceoBadgeSmall}>x2</span>}</div><div style={styles.voterTeam}>{voter.team}</div></div></div>
                      <div style={styles.voterActions}>
                        <div style={styles.voterScoreBox}><span style={styles.voterScore}>{voter.finalScore}</span><span style={styles.voterScoreUnit}>ì </span></div>
                        <button style={styles.deleteScoreBtn} onClick={(e) => { e.stopPropagation(); setDeleteConfirm({ presenter: selectedData.name, voter: voter.name, voterName: voter.name }); }}>ì‚­ì œ</button>
                      </div>
                    </div>
                  ))}
                </div>
                <div style={styles.totalSummary}><span>í‰ê·  ì ìˆ˜</span><span style={styles.totalSummaryValue}>{selectedData.averageScore}ì </span></div>
              </div>
            </div>
          )}
          {deleteConfirm && (
            <div style={styles.modalOverlay} onClick={() => setDeleteConfirm(null)}>
              <div style={{...styles.modal, maxWidth: '380px'}} onClick={e => e.stopPropagation()}>
                <div style={styles.modalHeader}><h3 style={{...styles.modalTitle, color: '#E54545'}}>âš ï¸ ë°°ì  ì‚­ì œ</h3><button style={styles.modalClose} onClick={() => setDeleteConfirm(null)}>âœ•</button></div>
                <div style={styles.deleteConfirmText}><strong>{deleteConfirm.voterName}</strong>ë‹˜ì´ <strong>{deleteConfirm.presenter}</strong>ë‹˜ì—ê²Œ ì¤€ ë°°ì ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
                <div style={styles.deleteWarning}>ì‚­ì œëœ ë°°ì ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>
                <div style={styles.modalActions}>
                  <button style={styles.cancelBtn} onClick={() => setDeleteConfirm(null)}>ì·¨ì†Œ</button>
                  <button style={styles.deleteConfirmBtn} onClick={() => { 
                    onScoreDelete(deleteConfirm.presenter, deleteConfirm.voter); 
                    setDeleteConfirm(null);
                    // ì‚­ì œ í›„ ë°œí‘œìì˜ í‰ê°€ìê°€ 0ëª…ì´ ë˜ë©´ ëª¨ë‹¬ ë‹«ê¸°
                    const updatedData = growthdayStats.find(r => r.name === deleteConfirm.presenter);
                    if (updatedData && updatedData.voterDetails.length <= 1) {
                      setSelectedPresenter(null);
                    }
                  }}>ì‚­ì œí•˜ê¸°</button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    const styles = {
      container: { minHeight: '100vh', backgroundColor: '#F7F8FA' },
      toast: { position: 'fixed', top: '24px', left: '50%', transform: 'translateX(-50%)', backgroundColor: '#FFF', padding: '12px 24px', borderRadius: '12px', boxShadow: '0 4px 20px rgba(0,0,0,0.15)', fontSize: '14px', fontWeight: '500', zIndex: 1000 },
      loginScreen: { minHeight: '100vh', backgroundColor: '#F7F8FA', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '20px' },
      loginCard: { backgroundColor: '#FFF', borderRadius: '24px', padding: '40px', width: '100%', maxWidth: '400px', boxShadow: '0 4px 24px rgba(0,0,0,0.08)' },
      loginHeader: { textAlign: 'center', marginBottom: '32px' },
      loginTitle: { fontSize: '24px', fontWeight: '700', color: '#191F28', marginBottom: '8px' },
      loginSubtitle: { fontSize: '15px', color: '#666' },
      inputGroup: { marginBottom: '20px' },
      inputLabel: { display: 'block', fontSize: '14px', fontWeight: '600', color: '#333', marginBottom: '8px' },
      input: { width: '100%', padding: '14px 16px', border: '1px solid #E5E5E5', borderRadius: '10px', fontSize: '15px', outline: 'none' },
      errorText: { color: '#E54545', fontSize: '13px', marginBottom: '16px' },
      loginBtn: { width: '100%', padding: '16px', border: 'none', backgroundColor: '#191F28', borderRadius: '12px', fontSize: '16px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      modalOverlay: { position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000 },
      modal: { backgroundColor: '#FFF', borderRadius: '20px', padding: '28px', width: '100%', maxWidth: '480px', maxHeight: '80vh', overflow: 'auto', margin: '20px' },
      modalHeader: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' },
      modalTitle: { fontSize: '20px', fontWeight: '700', color: '#191F28', display: 'flex', alignItems: 'center', gap: '10px' },
      modalCount: { padding: '4px 10px', backgroundColor: '#FEF1F1', color: '#E54545', borderRadius: '6px', fontSize: '14px', fontWeight: '600' },
      modalSubtitle: { fontSize: '14px', color: '#666', marginBottom: '20px' },
      modalClose: { background: 'none', border: 'none', cursor: 'pointer', fontSize: '20px', color: '#666' },
      modalActions: { display: 'flex', gap: '12px', marginTop: '24px' },
      cancelBtn: { flex: 1, padding: '14px', border: '1px solid #E5E5E5', backgroundColor: '#FFF', borderRadius: '10px', fontSize: '15px', fontWeight: '600', color: '#666', cursor: 'pointer' },
      confirmBtn: { flex: 1, padding: '14px', border: 'none', backgroundColor: '#3182F6', borderRadius: '10px', fontSize: '15px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      selectGroup: { marginBottom: '20px' },
      selectLabel: { display: 'block', fontSize: '14px', fontWeight: '600', color: '#333', marginBottom: '10px' },
      selectButtons: { display: 'flex', gap: '8px', flexWrap: 'wrap' },
      selectBtn: { padding: '12px 20px', border: '1px solid #E5E5E5', backgroundColor: '#FFF', borderRadius: '10px', fontSize: '15px', fontWeight: '500', color: '#666', cursor: 'pointer' },
      selectBtnActive: { backgroundColor: '#3182F6', borderColor: '#3182F6', color: '#FFF' },
      previewBanner: { padding: '16px', backgroundColor: '#E8F3FF', borderRadius: '10px', fontSize: '14px', color: '#3182F6', marginTop: '8px' },
      missingList: { maxHeight: '300px', overflowY: 'auto' },
      emptyMissing: { textAlign: 'center', padding: '40px 20px', color: '#00C471', fontSize: '15px', fontWeight: '500' },
      missingTeamGroup: { marginBottom: '16px' },
      missingTeamHeader: { display: 'flex', alignItems: 'center', gap: '8px', padding: '10px 0', fontSize: '14px', fontWeight: '600', color: '#191F28', borderBottom: '1px solid #F4F4F4' },
      teamDot: { width: '10px', height: '10px', borderRadius: '50%' },
      missingTeamCount: { marginLeft: 'auto', color: '#E54545', fontSize: '13px' },
      missingMembers: { padding: '8px 0' },
      missingMember: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '10px 0', fontSize: '14px', color: '#333' },
      quickCheckBtn: { padding: '6px 12px', border: '1px solid #3182F6', backgroundColor: '#E8F3FF', borderRadius: '6px', fontSize: '12px', fontWeight: '600', color: '#3182F6', cursor: 'pointer' },
      header: { backgroundColor: '#191F28', position: 'sticky', top: 0, zIndex: 100 },
      headerContent: { maxWidth: '1400px', margin: '0 auto', padding: '16px 24px', display: 'flex', alignItems: 'center', justifyContent: 'space-between' },
      logo: { display: 'flex', alignItems: 'center', gap: '12px' },
      logoText: { fontSize: '20px', fontWeight: '700', color: '#FFF' },
      adminBadge: { padding: '4px 10px', backgroundColor: '#3182F6', borderRadius: '4px', fontSize: '12px', fontWeight: '600', color: '#FFF' },
      nav: { display: 'flex', gap: '8px' },
      navButton: { padding: '10px 20px', border: 'none', backgroundColor: 'transparent', borderRadius: '8px', fontSize: '14px', fontWeight: '500', color: '#999', cursor: 'pointer' },
      navButtonActive: { backgroundColor: 'rgba(49,130,246,0.2)', color: '#3182F6' },
      logoutBtn: { padding: '10px 16px', border: '1px solid #444', backgroundColor: 'transparent', borderRadius: '8px', fontSize: '13px', fontWeight: '500', color: '#999', cursor: 'pointer' },
      main: { maxWidth: '1400px', margin: '0 auto', padding: '32px 24px' },
      page: {},
      pageHeader: { marginBottom: '28px' },
      pageTitle: { fontSize: '28px', fontWeight: '700', color: '#191F28', marginBottom: '8px' },
      pageSubtitle: { fontSize: '16px', color: '#666' },
      calendarContainer: { backgroundColor: '#FFF', borderRadius: '16px', padding: '24px', marginBottom: '24px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      calendarHeader: { display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '16px', marginBottom: '20px' },
      calendarNavBtn: { width: '36px', height: '36px', border: '1px solid #E5E5E5', backgroundColor: '#FFF', borderRadius: '8px', fontSize: '14px', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center' },
      calendarTitle: { fontSize: '18px', fontWeight: '700', color: '#191F28', minWidth: '140px', textAlign: 'center' },
      todayBtn: { padding: '8px 16px', border: '1px solid #3182F6', backgroundColor: '#E8F3FF', borderRadius: '8px', fontSize: '13px', fontWeight: '600', color: '#3182F6', cursor: 'pointer', marginLeft: '8px' },
      calendarDayNames: { display: 'grid', gridTemplateColumns: 'repeat(7, 1fr) 60px', gap: '4px', marginBottom: '8px' },
      calendarDayName: { textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#999', padding: '8px 0' },
      calendarBody: {},
      calendarWeekRow: { display: 'grid', gridTemplateColumns: 'repeat(7, 1fr) 60px', gap: '4px', padding: '8px 4px', borderRadius: '8px', marginBottom: '4px', transition: 'all 0.2s' },
      calendarWeekRowSelected: { backgroundColor: '#E8F3FF', boxShadow: '0 0 0 2px #3182F6' },
      calendarDay: { textAlign: 'center', fontSize: '14px', fontWeight: '500', color: '#191F28', padding: '8px 0' },
      calendarDayOtherMonth: { color: '#CCC' },
      calendarDayToday: { backgroundColor: '#3182F6', color: '#FFF', borderRadius: '50%', width: '28px', height: '28px', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto' },
      calendarDayWeekend: { color: '#E54545' },
      weekUploadRate: { fontSize: '12px', fontWeight: '700', textAlign: 'center', display: 'flex', alignItems: 'center', justifyContent: 'center' },
      calendarLegend: { display: 'flex', justifyContent: 'center', gap: '20px', marginTop: '16px', paddingTop: '16px', borderTop: '1px solid #F4F4F4' },
      legendItem: { display: 'flex', alignItems: 'center', gap: '6px', fontSize: '12px', color: '#666' },
      legendDot: { width: '8px', height: '8px', borderRadius: '50%' },
      selectedWeekBanner: { padding: '16px 20px', backgroundColor: '#E8F3FF', borderRadius: '12px', marginBottom: '24px', fontSize: '15px', color: '#3182F6' },
      summaryGrid: { display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '16px', marginBottom: '24px' },
      summaryCard: { backgroundColor: '#FFF', borderRadius: '16px', padding: '24px', textAlign: 'center', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      summaryValue: { fontSize: '32px', fontWeight: '700', color: '#191F28', marginBottom: '4px' },
      summaryLabel: { fontSize: '14px', color: '#666' },
      clickHint: { fontSize: '12px', color: '#3182F6', marginTop: '8px' },
      progressSection: { backgroundColor: '#FFF', borderRadius: '16px', padding: '24px', marginBottom: '24px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      progressHeader: { display: 'flex', justifyContent: 'space-between', marginBottom: '12px', fontSize: '14px', fontWeight: '500' },
      progressPercent: { color: '#3182F6', fontWeight: '700' },
      progressBarBg: { height: '12px', backgroundColor: '#E5E5E5', borderRadius: '6px', overflow: 'hidden' },
      progressBarFill: { height: '100%', backgroundColor: '#3182F6', borderRadius: '6px', transition: 'width 0.5s ease' },
      teamSection: { marginBottom: '24px' },
      sectionTitle: { fontSize: '18px', fontWeight: '600', color: '#191F28', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '12px' },
      teamGrid: { display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '16px' },
      teamCard: { backgroundColor: '#FFF', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      teamHeader: { display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px' },
      teamName: { fontSize: '14px', fontWeight: '600', color: '#191F28' },
      teamStatsRow: { marginBottom: '8px' },
      teamUploaded: { fontSize: '24px', fontWeight: '700', color: '#191F28' },
      teamTotal: { fontSize: '16px', color: '#666' },
      teamProgressBg: { height: '6px', backgroundColor: '#E5E5E5', borderRadius: '3px', overflow: 'hidden', marginBottom: '8px' },
      teamProgressFill: { height: '100%', borderRadius: '3px' },
      teamRate: { fontSize: '13px', fontWeight: '600', color: '#666', textAlign: 'right' },
      controlsRow: { marginBottom: '24px' },
      teamFilter: { padding: '10px 16px', border: '1px solid #E5E5E5', borderRadius: '8px', fontSize: '14px', backgroundColor: '#FFF', cursor: 'pointer', marginTop: '16px' },
      memberSection: {},
      memberTeamGroup: { backgroundColor: '#FFF', borderRadius: '12px', marginBottom: '12px', overflow: 'hidden', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      memberTeamHeader: { display: 'flex', alignItems: 'center', gap: '8px', padding: '16px 20px', backgroundColor: '#F7F8FA', fontSize: '14px', fontWeight: '600', color: '#191F28' },
      memberTeamCount: { marginLeft: 'auto', color: '#666', fontWeight: '500' },
      memberList: { padding: '12px 20px' },
      memberItem: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px 0', borderBottom: '1px solid #F4F4F4' },
      memberName: { fontSize: '14px', color: '#333', fontWeight: '500' },
      memberToggle: { padding: '6px 12px', border: '1px solid', borderRadius: '6px', fontSize: '13px', fontWeight: '600', cursor: 'pointer' },
      growthdayControlCard: { backgroundColor: '#FFF', borderRadius: '16px', padding: '28px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)', marginBottom: '16px' },
      growthdayControlHeader: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' },
      growthdayControlTitle: { fontSize: '18px', fontWeight: '600', color: '#191F28', marginBottom: '4px' },
      growthdayControlDesc: { fontSize: '14px', color: '#666' },
      startBtn: { padding: '12px 24px', border: 'none', backgroundColor: '#3182F6', borderRadius: '10px', fontSize: '15px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      stopBtn: { padding: '12px 24px', border: 'none', backgroundColor: '#E54545', borderRadius: '10px', fontSize: '15px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      statusBanner: { display: 'flex', alignItems: 'center', gap: '10px', padding: '16px 20px', borderRadius: '12px', fontSize: '14px', fontWeight: '500' },
      statusDot: { width: '8px', height: '8px', borderRadius: '50%' },
      scoreInfoCard: { padding: '16px 20px', backgroundColor: '#FFF8DC', borderRadius: '12px', marginBottom: '24px', fontSize: '14px', color: '#8B6914' },
      scoresSection: { marginTop: '24px' },
      scoresSectionHeader: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' },
      scoreCount: { fontSize: '14px', fontWeight: '500', color: '#666' },
      pdfExportBtn: { padding: '10px 20px', border: '1px solid #3182F6', backgroundColor: '#E8F3FF', borderRadius: '10px', fontSize: '14px', fontWeight: '600', color: '#3182F6', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '6px' },
      emptyState: { backgroundColor: '#FFF', borderRadius: '16px', padding: '64px', textAlign: 'center', boxShadow: '0 2px 10px rgba(0,0,0,0.05)', color: '#999' },
      scoresList: { display: 'flex', flexDirection: 'column', gap: '12px' },
      scoreCard: { display: 'flex', alignItems: 'center', gap: '16px', padding: '20px', backgroundColor: '#FFF', borderRadius: '12px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)', cursor: 'pointer' },
      scoreRank: { width: '32px', textAlign: 'center' },
      rankBadge: { width: '28px', height: '28px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '14px', fontWeight: '700', color: '#FFF' },
      rankNumber: { fontSize: '16px', fontWeight: '600', color: '#999' },
      scoreAvatar: { width: '44px', height: '44px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#FFF', fontSize: '16px', fontWeight: '600' },
      scoreInfo: { flex: 1 },
      scoreName: { fontSize: '16px', fontWeight: '600', color: '#191F28' },
      scoreTeam: { fontSize: '13px', color: '#666' },
      scoreVoters: { padding: '6px 12px', backgroundColor: '#F7F8FA', borderRadius: '6px', fontSize: '13px', color: '#666' },
      scoreTotalValue: { textAlign: 'right', minWidth: '80px' },
      scoreNumber: { fontSize: '24px', fontWeight: '700', color: '#3182F6' },
      scoreUnit: { fontSize: '14px', color: '#666', marginLeft: '2px' },
      detailArrow: { fontSize: '16px', color: '#CCC' },
      modalAvatar: { width: '32px', height: '32px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#FFF', fontSize: '14px', fontWeight: '600' },
      voterList: { display: 'flex', flexDirection: 'column', gap: '12px', marginTop: '20px' },
      voterItem: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '16px', backgroundColor: '#F7F8FA', borderRadius: '12px' },
      voterInfo: { display: 'flex', alignItems: 'center', gap: '12px' },
      voterAvatar: { width: '40px', height: '40px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#FFF', fontSize: '14px', fontWeight: '600' },
      voterName: { fontSize: '15px', fontWeight: '600', color: '#191F28', display: 'flex', alignItems: 'center', gap: '6px' },
      voterTeam: { fontSize: '13px', color: '#666' },
      ceoBadgeSmall: { padding: '2px 6px', backgroundColor: '#FFE066', borderRadius: '4px', fontSize: '11px', fontWeight: '700', color: '#8B6914' },
      voterScoreBox: { textAlign: 'right' },
      voterScore: { fontSize: '20px', fontWeight: '700', color: '#3182F6' },
      voterScoreUnit: { fontSize: '13px', color: '#666', marginLeft: '2px' },
      voterActions: { display: 'flex', alignItems: 'center', gap: '12px' },
      deleteScoreBtn: { padding: '6px 12px', border: '1px solid #E54545', backgroundColor: '#FEF1F1', borderRadius: '6px', fontSize: '12px', fontWeight: '600', color: '#E54545', cursor: 'pointer' },
      deleteConfirmText: { fontSize: '15px', color: '#333', lineHeight: '1.6', marginBottom: '12px' },
      deleteWarning: { fontSize: '13px', color: '#E54545', padding: '12px', backgroundColor: '#FEF1F1', borderRadius: '8px', marginBottom: '20px' },
      deleteConfirmBtn: { flex: 1, padding: '14px', border: 'none', backgroundColor: '#E54545', borderRadius: '10px', fontSize: '15px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      totalSummary: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '16px 20px', backgroundColor: '#E8F3FF', borderRadius: '12px', marginTop: '16px', fontSize: '15px', fontWeight: '600', color: '#3182F6' },
      totalSummaryValue: { fontSize: '20px', fontWeight: '700' },
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
