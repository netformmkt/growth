<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê·¸ë¡œìŠ¤ë³´ë“œ - Admin</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif; }
    button:hover { opacity: 0.9; }
    input:focus { border-color: #3182F6 !important; outline: none; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-thumb { background: #DDD; border-radius: 3px; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const firebaseConfig = {
      apiKey: "AIzaSyALgLMu9taflcnSnydKRruhYpXDC9TFBtE",
      authDomain: "growthboard-e79f8.firebaseapp.com",
      databaseURL: "https://growthboard-e79f8-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "growthboard-e79f8",
      storageBucket: "growthboard-e79f8.firebasestorage.app",
      messagingSenderId: "863471619047",
      appId: "1:863471619047:web:8fe329ab0ee765317c0b42"
    };

    let db = null;
    try { firebase.initializeApp(firebaseConfig); db = firebase.database(); } catch (e) {}

    const TEAMS_DATA = {
      "ëŒ€í‘œì´ì‚¬ì‹¤": ["ì´ìŠ¹ìš°"],
      "ê²½ì˜ê´€ë¦¬ë³¸ë¶€": ["ë°±ì •ì„"],
      "ê²½ì˜ê´€ë¦¬íŒ€": ["ì‹ ë‚˜ì˜", "ì£¼ìœ ì§„", "ê¹€ìœ ë¦¼"],
      "ê·¸ë¡œìŠ¤íŒ€": ["ì´ì¬í›ˆ", "ê¹€ë²”ì„"],
      "ì˜ì—…ë³¸ë¶€": ["í™©ìœ¤ì„ "],
      "ì„œë¹„ìŠ¤ìš´ì˜1íŒ€": ["í•œì¤€ì—½", "ì¡°ì¬ì—°", "ì •ì •í›ˆ", "ê¹€ì„±ë¯¼", "í•œì§€í˜œ"],
      "ì„œë¹„ìŠ¤ìš´ì˜2íŒ€": ["ê¶Œì •ì•„", "ê¹€ìˆ˜ì§„"],
      "ì„œë¹„ìŠ¤ìš´ì˜3íŒ€": ["ì£¼í˜„ì§„", "ì†¡ë³´ëŒ"],
      "ì•„íŒŒíŠ¸ìŠ¤í€˜ì–´íŒ€": ["í•œì¸ê·œ"],
      "ì ì‚°íŒ€": ["ê¹€ì˜ì„±", "ì‹ ìˆ˜ì§„"],
      "ì„¤ê³„/ì ì‚°íŒ€": ["ì¡°í˜„ì‹"],
      "ê¸°ìˆ ì—°êµ¬ì†Œ": ["ì‹ ëª…í¬", "ì‹¬í˜œì§„", "ê¹€ì†Œì •"],
      "ë¸Œëœë“œë§ˆì¼€íŒ…íŒ€": ["ê¶Œí˜œì˜", "í•¨ì§€ë¯¼", "ê¹€ì†Œë¼", "ì†ì˜ˆì§„", "ìµœê²½ì„ "],
      "ì»¤ë¨¸ìŠ¤ì‚¬ì—…ë³¸ë¶€": ["í—ˆì§€ì€"],
      "ë¸Œëœë“œì»¤ë¨¸ìŠ¤íŒ€": ["ì´ë€", "ê¹€ë¯¼ì§€"],
      "ë¯¸ë””ì–´ì»¤ë¨¸ìŠ¤íŒ€": ["ë°©í˜„ìˆ˜", "ê¹€ì†Œì—°", "ë‚¨ìœ¤ì •"],
      "í•´ì™¸ì‚¬ì—…íŒ€": ["ê¹€ì±„ì›", "ì©í‹°ë¦¬"],
      "ëª¨ì—¬ë¼ë”œíŒ€": ["ê¹€ì†¡í¬", "ì´ì±„ì€"]
    };

    // ë³¸ë¶€ë³„ ìƒ‰ìƒ í†µì¼
    const TEAM_COLORS = {
      "ëŒ€í‘œì´ì‚¬ì‹¤": "#191F28",
      // ê²½ì˜ê´€ë¦¬ë³¸ë¶€ ê³„ì—´ (íŒŒë€ìƒ‰)
      "ê²½ì˜ê´€ë¦¬ë³¸ë¶€": "#3182F6", "ê²½ì˜ê´€ë¦¬íŒ€": "#3182F6", "ê·¸ë¡œìŠ¤íŒ€": "#5B9DF6",
      // ì˜ì—…ë³¸ë¶€ ê³„ì—´ (ë³´ë¼ìƒ‰)
      "ì˜ì—…ë³¸ë¶€": "#9B59B6", "ì„œë¹„ìŠ¤ìš´ì˜1íŒ€": "#9B59B6", "ì„œë¹„ìŠ¤ìš´ì˜2íŒ€": "#A96DC7", "ì„œë¹„ìŠ¤ìš´ì˜3íŒ€": "#B77FD8",
      "ì•„íŒŒíŠ¸ìŠ¤í€˜ì–´íŒ€": "#9B59B6", "ì ì‚°íŒ€": "#A96DC7", "ì„¤ê³„/ì ì‚°íŒ€": "#B77FD8",
      // ê¸°ìˆ ì—°êµ¬ì†Œ (ë…ë¦½ - ì§„í•œ ì²­ë¡ìƒ‰)
      "ê¸°ìˆ ì—°êµ¬ì†Œ": "#0891B2",
      // ë¸Œëœë“œë§ˆì¼€íŒ…íŒ€ (ë…ë¦½ - ì£¼í™©ìƒ‰)
      "ë¸Œëœë“œë§ˆì¼€íŒ…íŒ€": "#F39C12",
      // ì»¤ë¨¸ìŠ¤ì‚¬ì—…ë³¸ë¶€ ê³„ì—´ (ë ˆë“œ/í•‘í¬ ê³„ì—´)
      "ì»¤ë¨¸ìŠ¤ì‚¬ì—…ë³¸ë¶€": "#E11D48", "ë¸Œëœë“œì»¤ë¨¸ìŠ¤íŒ€": "#E11D48", "ë¯¸ë””ì–´ì»¤ë¨¸ìŠ¤íŒ€": "#F43F5E",
      "í•´ì™¸ì‚¬ì—…íŒ€": "#FB7185", "ëª¨ì—¬ë¼ë”œíŒ€": "#E11D48"
    };

    // ì—…ë¡œë“œ ì²´í¬ ì œì™¸ ì¸ì› (ê·¸ë¡œìŠ¤ë°ì´ ì±„ì ë§Œ ì°¸ì—¬)
    const EXCLUDED_FROM_UPLOAD = ["ë°±ì •ì„", "í™©ìœ¤ì„ ", "ì¡°í˜„ì‹", "í—ˆì§€ì€"];

    const REGULAR_TEAMS = Object.fromEntries(Object.entries(TEAMS_DATA).filter(([team]) => team !== "ëŒ€í‘œì´ì‚¬ì‹¤"));

    const getWeekInfo = (date = new Date()) => {
      const d = new Date(date);
      const dayOfWeek = d.getDay();
      const daysSinceMonday = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
      const monday = new Date(d);
      monday.setDate(d.getDate() - daysSinceMonday);
      const sunday = new Date(monday);
      sunday.setDate(monday.getDate() + 6);
      const weekId = monday.getFullYear() + '-' + String(monday.getMonth()+1).padStart(2,'0') + '-' + String(monday.getDate()).padStart(2,'0');
      const label = monday.getMonth() === sunday.getMonth() 
        ? (monday.getMonth()+1) + '/' + monday.getDate() + '~' + sunday.getDate()
        : (monday.getMonth()+1) + '/' + monday.getDate() + '~' + (sunday.getMonth()+1) + '/' + sunday.getDate();
      return { weekId, monday, sunday, label };
    };

    const generateEmptyUploadStatus = () => {
      const status = {};
      Object.entries(REGULAR_TEAMS).forEach(([team, members]) => {
        members.filter(m => !EXCLUDED_FROM_UPLOAD.includes(m)).forEach(member => { status[member] = { team, weeks: {} }; });
      });
      return status;
    };

    function App() {
      const [isLoggedIn, setIsLoggedIn] = useState(() => localStorage.getItem('growthboard_admin_logged_in') === 'true');
      const [currentTab, setCurrentTab] = useState('dashboard');
      const [uploadStatus, setUploadStatus] = useState(generateEmptyUploadStatus());
      const [scores, setScores] = useState({});
      const [growthdayActive, setGrowthdayActive] = useState(false);
      const [growthdayQuarter, setGrowthdayQuarter] = useState('');
      const [isLoading, setIsLoading] = useState(true);
      const [selectedWeek, setSelectedWeek] = useState(getWeekInfo().weekId);
      const [toast, setToast] = useState(null);
      const [selectedTeamFilter, setSelectedTeamFilter] = useState('all');
      const [showMissingModal, setShowMissingModal] = useState(false);
      const [showGrowthdayModal, setShowGrowthdayModal] = useState(false);

      useEffect(() => {
        if (!db) { setIsLoading(false); return; }
        
        // íƒ€ì„ì•„ì›ƒ ì„¤ì • (5ì´ˆ í›„ì—ë„ ë¡œë”© ì¤‘ì´ë©´ ê°•ì œ í•´ì œ)
        const timeout = setTimeout(() => {
          setIsLoading(false);
          console.log('Firebase ì—°ê²° íƒ€ì„ì•„ì›ƒ');
        }, 5000);
        
        const uploadRef = db.ref('uploadStatus');
        uploadRef.on('value', (snapshot) => {
          clearTimeout(timeout);
          const data = snapshot.val();
          if (data) {
            setUploadStatus(() => {
              const merged = generateEmptyUploadStatus();
              Object.keys(data).forEach(member => {
                if (merged[member]) merged[member].weeks = data[member].weeks || {};
              });
              return merged;
            });
          }
          setIsLoading(false);
        }, (error) => {
          clearTimeout(timeout);
          console.error('Firebase ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
          setIsLoading(false);
        });
        const scoresRef = db.ref('scores');
        scoresRef.on('value', (snapshot) => { if (snapshot.val()) setScores(snapshot.val()); }, (error) => console.error('scores ë¡œë“œ ì˜¤ë¥˜:', error));
        const growthdayRef = db.ref('growthday');
        growthdayRef.on('value', (snapshot) => {
          const data = snapshot.val();
          if (data) { setGrowthdayActive(data.active || false); setGrowthdayQuarter(data.quarter || ''); }
        }, (error) => console.error('growthday ë¡œë“œ ì˜¤ë¥˜:', error));
        return () => { clearTimeout(timeout); uploadRef.off(); scoresRef.off(); growthdayRef.off(); };
      }, []);

      useEffect(() => { localStorage.setItem('growthboard_admin_logged_in', isLoggedIn.toString()); }, [isLoggedIn]);

      const showToast = (msg) => { setToast(msg); setTimeout(() => setToast(null), 2500); };

      const handleUploadToggle = (member, weekId) => {
        if (!db) { showToast('Firebase ì—°ê²° í•„ìš”'); return; }
        const newStatus = !(uploadStatus[member]?.weeks?.[weekId] || false);
        db.ref('uploadStatus/' + member + '/weeks/' + weekId).set(newStatus)
          .then(() => showToast(member + 'ë‹˜ì˜ ì—…ë¡œë“œ ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤'))
          .catch((error) => { console.error('Firebase ì“°ê¸° ì˜¤ë¥˜:', error); showToast('ì €ì¥ ì‹¤íŒ¨: Firebase ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”'); });
      };

      const handleGrowthdayStart = (year, quarter) => {
        if (!db) { showToast('Firebase ì—°ê²° í•„ìš”'); return; }
        db.ref('growthday').set({ active: true, quarter: year + 'ë…„ ' + quarter + 'ë¶„ê¸°' })
          .then(() => { setShowGrowthdayModal(false); showToast(year + 'ë…„ ' + quarter + 'ë¶„ê¸° ê·¸ë¡œìŠ¤ë°ì´ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤'); })
          .catch((error) => { console.error('Firebase ì“°ê¸° ì˜¤ë¥˜:', error); showToast('ì €ì¥ ì‹¤íŒ¨: Firebase ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”'); });
      };

      const handleGrowthdayStop = () => {
        if (!db) { showToast('Firebase ì—°ê²° í•„ìš”'); return; }
        db.ref('growthday/active').set(false)
          .then(() => showToast('ê·¸ë¡œìŠ¤ë°ì´ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤'))
          .catch((error) => { console.error('Firebase ì“°ê¸° ì˜¤ë¥˜:', error); showToast('ì €ì¥ ì‹¤íŒ¨: Firebase ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”'); });
      };

      const handleDeleteScore = (presenter, voter, quarter) => {
        if (!db) { showToast('Firebase ì—°ê²° í•„ìš”'); return; }
        const targetQuarter = quarter || growthdayQuarter;
        if (!window.confirm(`${voter}ë‹˜ì´ ${presenter}ë‹˜ì—ê²Œ ì¤€ ì ìˆ˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
        db.ref(`scores/${targetQuarter}/${presenter}/${voter}`).remove()
          .then(() => showToast(`${voter}ë‹˜ì˜ ì ìˆ˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`))
          .catch((error) => { console.error('Firebase ì‚­ì œ ì˜¤ë¥˜:', error); showToast('ì‚­ì œ ì‹¤íŒ¨: Firebase ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”'); });
      };

      const handleUpdateScore = (presenter, voter, newScores, isCEO, quarter) => {
        if (!db) { showToast('Firebase ì—°ê²° í•„ìš”'); return; }
        const targetQuarter = quarter || growthdayQuarter;
        db.ref(`scores/${targetQuarter}/${presenter}/${voter}`).set({ scores: newScores, isCEO })
          .then(() => showToast(`${voter}ë‹˜ì˜ ì ìˆ˜ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤`))
          .catch((error) => { console.error('Firebase ìˆ˜ì • ì˜¤ë¥˜:', error); showToast('ìˆ˜ì • ì‹¤íŒ¨: Firebase ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”'); });
      };

      const getStats = () => {
        const totalMembers = Object.keys(uploadStatus).length;
        const currentWeekUploads = Object.values(uploadStatus).filter(s => s.weeks?.[selectedWeek]).length;
        const teamStats = {};
        Object.entries(REGULAR_TEAMS).forEach(([team, members]) => {
          const uploaded = members.filter(m => uploadStatus[m]?.weeks?.[selectedWeek]).length;
          teamStats[team] = { total: members.length, uploaded, rate: Math.round((uploaded / members.length) * 100) };
        });
        const missingMembers = [];
        Object.entries(uploadStatus).forEach(([name, data]) => {
          if (!data.weeks?.[selectedWeek]) missingMembers.push({ name, team: data.team });
        });
        return { totalMembers, currentWeekUploads, overallRate: Math.round((currentWeekUploads / totalMembers) * 100), teamStats, missingMembers };
      };

      const getGrowthdayStats = () => {
        const quarterScores = scores[growthdayQuarter] || {};
        const results = [];
        Object.entries(quarterScores).forEach(([presenter, voters]) => {
          const voterList = Object.entries(voters);
          if (voterList.length === 0) return;
          
          const voterDetails = [];
          const ceoVoters = [];
          const regularVoters = [];
          
          voterList.forEach(([voter, data]) => {
            const baseScore = Object.values(data.scores).reduce((a, b) => a + b, 0);
            const finalScore = data.isCEO ? baseScore * 2 : baseScore;
            const voterTeam = Object.entries(TEAMS_DATA).find(([t, members]) => members.includes(voter))?.[0] || '';
            const voterData = { name: voter, team: voterTeam, baseScore, finalScore, isCEO: data.isCEO };
            voterDetails.push(voterData);
            
            if (data.isCEO) {
              ceoVoters.push(voterData);
            } else {
              regularVoters.push(voterData);
            }
          });
          
          // ì¼ë°˜ í‰ê°€ì ì¤‘ ìµœê³ ì /ìµœì €ì  ì œì™¸ (3ëª… ì´ìƒì¼ ë•Œë§Œ)
          let filteredRegularVoters = [...regularVoters];
          let excludedVoters = [];
          if (regularVoters.length >= 3) {
            const sorted = [...regularVoters].sort((a, b) => a.finalScore - b.finalScore);
            const minVoter = sorted[0];
            const maxVoter = sorted[sorted.length - 1];
            excludedVoters = [minVoter.name, maxVoter.name];
            filteredRegularVoters = regularVoters.filter(v => v.name !== minVoter.name && v.name !== maxVoter.name);
          }
          
          // í‰ê·  ê³„ì‚°: ëŒ€í‘œ + í•„í„°ë§ëœ ì¼ë°˜ í‰ê°€ì
          const countedVoters = [...ceoVoters, ...filteredRegularVoters];
          const totalScore = countedVoters.reduce((sum, v) => sum + v.finalScore, 0);
          const averageScore = countedVoters.length > 0 ? totalScore / countedVoters.length : 0;
          
          const team = Object.entries(TEAMS_DATA).find(([t, members]) => members.includes(presenter))?.[0] || '';
          results.push({ 
            name: presenter, 
            team, 
            voterCount: voterList.length, 
            countedVoterCount: countedVoters.length,
            averageScore: averageScore.toFixed(1), 
            ceoVoted: ceoVoters.length > 0, 
            voterDetails: voterDetails.map(v => ({...v, excluded: excludedVoters.includes(v.name)})), 
            totalScore,
            excludedVoters
          });
        });
        return results.sort((a, b) => parseFloat(b.averageScore) - parseFloat(a.averageScore));
      };

      const stats = getStats();
      const growthdayStats = getGrowthdayStats();

      if (isLoading) return <div style={{minHeight:'100vh',display:'flex',alignItems:'center',justifyContent:'center',backgroundColor:'#F7F8FA'}}><div style={{textAlign:'center'}}><div style={{fontSize:'24px',marginBottom:'12px'}}>â³</div><div style={{color:'#666'}}>ë¡œë”© ì¤‘...</div></div></div>;
      if (!isLoggedIn) return <AdminLoginScreen onLogin={() => setIsLoggedIn(true)} />;

      return (
        <div style={styles.container}>
          {toast && <div style={styles.toast}>âœ“ {toast}</div>}
          {showMissingModal && <MissingModal stats={stats} selectedWeek={selectedWeek} onClose={() => setShowMissingModal(false)} onToggle={handleUploadToggle} />}
          {showGrowthdayModal && <GrowthdayStartModal onClose={() => setShowGrowthdayModal(false)} onStart={handleGrowthdayStart} />}
          <header style={styles.header}>
            <div style={styles.headerContent}>
              <div style={styles.logo}><span style={styles.logoText}>ê·¸ë¡œìŠ¤ë³´ë“œ</span><span style={styles.adminBadge}>Admin</span></div>
              <nav style={styles.nav}>
                <button style={{...styles.navButton, ...(currentTab === 'dashboard' ? styles.navButtonActive : {})}} onClick={() => setCurrentTab('dashboard')}>ëŒ€ì‹œë³´ë“œ</button>
                <button style={{...styles.navButton, ...(currentTab === 'members' ? styles.navButtonActive : {})}} onClick={() => setCurrentTab('members')}>ì¸ì› ê´€ë¦¬</button>
                <button style={{...styles.navButton, ...(currentTab === 'growthday' ? styles.navButtonActive : {})}} onClick={() => setCurrentTab('growthday')}>ê·¸ë¡œìŠ¤ë°ì´ ê´€ë¦¬</button>
              </nav>
              <button style={styles.logoutBtn} onClick={() => setIsLoggedIn(false)}>ë¡œê·¸ì•„ì›ƒ</button>
            </div>
          </header>
          <main style={styles.main}>
            {currentTab === 'dashboard' && <DashboardTab stats={stats} selectedWeek={selectedWeek} setSelectedWeek={setSelectedWeek} growthdayActive={growthdayActive} growthdayQuarter={growthdayQuarter} onMissingClick={() => setShowMissingModal(true)} uploadStatus={uploadStatus} />}
            {currentTab === 'members' && <MembersTab uploadStatus={uploadStatus} stats={stats} selectedWeek={selectedWeek} setSelectedWeek={setSelectedWeek} onToggle={handleUploadToggle} selectedTeamFilter={selectedTeamFilter} setSelectedTeamFilter={setSelectedTeamFilter} />}
            {currentTab === 'growthday' && <GrowthdayTab growthdayActive={growthdayActive} growthdayQuarter={growthdayQuarter} growthdayStats={growthdayStats} scores={scores} onStartClick={() => setShowGrowthdayModal(true)} onStop={handleGrowthdayStop} onDeleteScore={handleDeleteScore} onUpdateScore={handleUpdateScore} />}
          </main>
        </div>
      );
    }

    function AdminLoginScreen({ onLogin }) {
      const [id, setId] = useState('');
      const [pw, setPw] = useState('');
      const [error, setError] = useState('');
      const handleLogin = () => { if (id === 'admin' && pw === 'admin') onLogin(); else setError('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤'); };
      return (
        <div style={styles.loginScreen}>
          <div style={styles.loginCard}>
            <div style={styles.loginHeader}><h1 style={styles.loginTitle}>ê·¸ë¡œìŠ¤ë³´ë“œ Admin</h1><p style={styles.loginSubtitle}>ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”</p></div>
            <div style={styles.inputGroup}><label style={styles.inputLabel}>ì•„ì´ë””</label><input type="text" value={id} onChange={e => { setId(e.target.value); setError(''); }} onKeyPress={e => e.key === 'Enter' && handleLogin()} style={styles.input} placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”" /></div>
            <div style={styles.inputGroup}><label style={styles.inputLabel}>ë¹„ë°€ë²ˆí˜¸</label><input type="password" value={pw} onChange={e => { setPw(e.target.value); setError(''); }} onKeyPress={e => e.key === 'Enter' && handleLogin()} style={styles.input} placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" /></div>
            {error && <div style={styles.errorText}>{error}</div>}
            <button style={styles.loginBtn} onClick={handleLogin}>ë¡œê·¸ì¸</button>
          </div>
        </div>
      );
    }

    function MissingModal({ stats, selectedWeek, onClose, onToggle }) {
      const [year, month, day] = selectedWeek.split('-').map(Number);
      const monday = new Date(year, month - 1, day);
      const sunday = new Date(monday); sunday.setDate(monday.getDate() + 6);
      const label = (monday.getMonth()+1) + '/' + monday.getDate() + '~' + (sunday.getMonth()+1) + '/' + sunday.getDate();
      return (
        <div style={styles.modalOverlay} onClick={onClose}>
          <div style={styles.modal} onClick={e => e.stopPropagation()}>
            <div style={styles.modalHeader}><h3 style={styles.modalTitle}>ë¯¸ì—…ë¡œë“œ ì¸ì› <span style={styles.modalCount}>{stats.missingMembers.length}ëª…</span></h3><button style={styles.modalClose} onClick={onClose}>âœ•</button></div>
            <div style={styles.modalSubtitle}>{label} ê¸°ì¤€</div>
            <div style={styles.missingList}>
              {stats.missingMembers.length === 0 ? <div style={styles.emptyMissing}>âœ“ ëª¨ë“  ì¸ì›ì´ ì—…ë¡œë“œë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!</div> :
                Object.entries(REGULAR_TEAMS).map(([team]) => {
                  const missingInTeam = stats.missingMembers.filter(m => m.team === team);
                  if (missingInTeam.length === 0) return null;
                  return (
                    <div key={team} style={styles.missingTeamGroup}>
                      <div style={styles.missingTeamHeader}><div style={{...styles.teamDot, backgroundColor: TEAM_COLORS[team]}} /><span>{team}</span><span style={styles.missingTeamCount}>{missingInTeam.length}ëª…</span></div>
                      <div style={styles.missingMembers}>{missingInTeam.map(member => <div key={member.name} style={styles.missingMember}><span>{member.name}</span><button style={styles.quickCheckBtn} onClick={() => onToggle(member.name, selectedWeek)}>ì™„ë£Œ ì²˜ë¦¬</button></div>)}</div>
                    </div>
                  );
                })}
            </div>
          </div>
        </div>
      );
    }

    function GrowthdayStartModal({ onClose, onStart }) {
      const currentYear = new Date().getFullYear();
      const [year, setYear] = useState(currentYear);
      const [quarter, setQuarter] = useState(Math.ceil((new Date().getMonth() + 1) / 3));
      return (
        <div style={styles.modalOverlay} onClick={onClose}>
          <div style={styles.modal} onClick={e => e.stopPropagation()}>
            <div style={styles.modalHeader}><h3 style={styles.modalTitle}>ê·¸ë¡œìŠ¤ë°ì´ ì‹œì‘</h3><button style={styles.modalClose} onClick={onClose}>âœ•</button></div>
            <div style={styles.modalSubtitle}>ë°°ì ì„ ì§„í–‰í•  ë¶„ê¸°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
            <div style={styles.selectGroup}><label style={styles.selectLabel}>ì—°ë„</label><div style={styles.selectButtons}>{[currentYear, currentYear+1, currentYear+2, currentYear+3].map(y => <button key={y} style={{...styles.selectBtn, ...(year === y ? styles.selectBtnActive : {})}} onClick={() => setYear(y)}>{y}ë…„</button>)}</div></div>
            <div style={styles.selectGroup}><label style={styles.selectLabel}>ë¶„ê¸°</label><div style={styles.selectButtons}>{[1,2,3,4].map(q => <button key={q} style={{...styles.selectBtn, ...(quarter === q ? styles.selectBtnActive : {})}} onClick={() => setQuarter(q)}>{q}ë¶„ê¸°</button>)}</div></div>
            <div style={styles.previewBanner}>ğŸ“Œ <strong>{year}ë…„ {quarter}ë¶„ê¸°</strong> ê·¸ë¡œìŠ¤ë°ì´ê°€ ì‹œì‘ë©ë‹ˆë‹¤</div>
            <div style={styles.modalActions}><button style={styles.cancelBtn} onClick={onClose}>ì·¨ì†Œ</button><button style={styles.confirmBtn} onClick={() => onStart(year, quarter)}>ì‹œì‘í•˜ê¸°</button></div>
          </div>
        </div>
      );
    }

    function WeekCalendar({ selectedWeek, setSelectedWeek, uploadStatus }) {
      const [currentMonth, setCurrentMonth] = useState(() => new Date(new Date().getFullYear(), new Date().getMonth(), 1));

      const getDaysInMonth = (date) => {
        const year = date.getFullYear();
        const month = date.getMonth();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const days = [];
        let startDay = firstDay.getDay();
        startDay = startDay === 0 ? 6 : startDay - 1;
        for (let i = 0; i < startDay; i++) {
          const prevDate = new Date(year, month, -startDay + i + 1);
          days.push({ date: prevDate, isCurrentMonth: false });
        }
        for (let i = 1; i <= lastDay.getDate(); i++) {
          days.push({ date: new Date(year, month, i), isCurrentMonth: true });
        }
        const remainingDays = 7 - (days.length % 7);
        if (remainingDays < 7) {
          for (let i = 1; i <= remainingDays; i++) {
            days.push({ date: new Date(year, month + 1, i), isCurrentMonth: false });
          }
        }
        return days;
      };

      const getWeekIdFromDate = (date) => {
        const d = new Date(date);
        const dayOfWeek = d.getDay();
        const daysSinceMonday = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
        const monday = new Date(d);
        monday.setDate(d.getDate() - daysSinceMonday);
        return monday.getFullYear() + '-' + String(monday.getMonth()+1).padStart(2,'0') + '-' + String(monday.getDate()).padStart(2,'0');
      };

      const getWeekUploadRate = (weekId) => {
        const totalMembers = Object.keys(uploadStatus).length;
        if (totalMembers === 0) return 0;
        const uploaded = Object.values(uploadStatus).filter(s => s.weeks?.[weekId]).length;
        return Math.round((uploaded / totalMembers) * 100);
      };

      const days = getDaysInMonth(currentMonth);
      const weeks = [];
      for (let i = 0; i < days.length; i += 7) weeks.push(days.slice(i, i + 7));

      const prevMonth = () => setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1, 1));
      const nextMonth = () => setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 1));
      const goToToday = () => {
        const today = new Date();
        setCurrentMonth(new Date(today.getFullYear(), today.getMonth(), 1));
        setSelectedWeek(getWeekIdFromDate(today));
      };

      const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
      const dayNames = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];

      return (
        <div style={styles.calendarContainer}>
          <div style={styles.calendarHeader}>
            <button style={styles.calendarNavBtn} onClick={prevMonth}>â—€</button>
            <span style={styles.calendarTitle}>{currentMonth.getFullYear()}ë…„ {monthNames[currentMonth.getMonth()]}</span>
            <button style={styles.calendarNavBtn} onClick={nextMonth}>â–¶</button>
            <button style={styles.todayBtn} onClick={goToToday}>ì˜¤ëŠ˜</button>
          </div>
          <div style={styles.calendarDayNames}>{dayNames.map(day => <div key={day} style={styles.calendarDayName}>{day}</div>)}<div style={styles.calendarDayName}>ì§„í–‰ë¥ </div></div>
          <div style={styles.calendarBody}>
            {weeks.map((week, weekIndex) => {
              const weekId = getWeekIdFromDate(week[0].date);
              const isSelected = weekId === selectedWeek;
              const uploadRate = getWeekUploadRate(weekId);
              return (
                <div key={weekIndex} style={{...styles.calendarWeekRow, ...(isSelected ? styles.calendarWeekRowSelected : {}), cursor: 'pointer'}} onClick={() => setSelectedWeek(weekId)}>
                  {week.map((dayObj, dayIndex) => {
                    const isToday = dayObj.date.toDateString() === new Date().toDateString();
                    return (
                      <div key={dayIndex} style={{...styles.calendarDay, ...(dayObj.isCurrentMonth ? {} : styles.calendarDayOtherMonth), ...(isToday ? styles.calendarDayToday : {}), ...(dayIndex >= 5 ? styles.calendarDayWeekend : {})}}>
                        {dayObj.date.getDate()}
                      </div>
                    );
                  })}
                  <div style={{...styles.weekUploadRate, color: uploadRate === 100 ? '#00C471' : uploadRate > 0 ? '#3182F6' : '#CCC'}}>{uploadRate}%</div>
                </div>
              );
            })}
          </div>
          <div style={styles.calendarLegend}>
            <span style={styles.legendItem}><span style={{...styles.legendDot, backgroundColor: '#00C471'}}></span> ì™„ë£Œ</span>
            <span style={styles.legendItem}><span style={{...styles.legendDot, backgroundColor: '#3182F6'}}></span> ì§„í–‰ì¤‘</span>
            <span style={styles.legendItem}><span style={{...styles.legendDot, backgroundColor: '#CCC'}}></span> ë¯¸ì‹œì‘</span>
          </div>
        </div>
      );
    }

    function DashboardTab({ stats, selectedWeek, setSelectedWeek, growthdayActive, growthdayQuarter, onMissingClick, uploadStatus }) {
      const [year, month, day] = selectedWeek.split('-').map(Number);
      const monday = new Date(year, month - 1, day);
      const sunday = new Date(monday); sunday.setDate(monday.getDate() + 6);
      const selectedWeekLabel = (monday.getMonth()+1) + '/' + monday.getDate() + '~' + (sunday.getMonth()+1) + '/' + sunday.getDate();

      return (
        <div style={styles.page}>
          <div style={styles.pageHeader}><h1 style={styles.pageTitle}>ëŒ€ì‹œë³´ë“œ</h1><p style={styles.pageSubtitle}>ê·¸ë¡œìŠ¤ë³´ë“œ ì—…ë¡œë“œ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p></div>
          <WeekCalendar selectedWeek={selectedWeek} setSelectedWeek={setSelectedWeek} uploadStatus={uploadStatus} />
          <div style={styles.selectedWeekBanner}>ğŸ“… ì„ íƒëœ ì£¼: <strong>{selectedWeekLabel}</strong></div>
          <div style={styles.summaryGrid}>
            <div style={styles.summaryCard}><div style={styles.summaryValue}>{stats.totalMembers}</div><div style={styles.summaryLabel}>ì´ ì¸ì›</div></div>
            <div style={styles.summaryCard}><div style={{...styles.summaryValue, color: '#00C471'}}>{stats.currentWeekUploads}</div><div style={styles.summaryLabel}>ì—…ë¡œë“œ ì™„ë£Œ</div></div>
            <div style={{...styles.summaryCard, cursor: 'pointer'}} onClick={onMissingClick}><div style={{...styles.summaryValue, color: '#E54545'}}>{stats.totalMembers - stats.currentWeekUploads}</div><div style={styles.summaryLabel}>ë¯¸ì—…ë¡œë“œ</div><div style={styles.clickHint}>í´ë¦­í•˜ì—¬ ìƒì„¸ë³´ê¸° â†’</div></div>
            <div style={styles.summaryCard}><div style={{...styles.summaryValue, color: growthdayActive ? '#00C471' : '#999', fontSize: '20px'}}>{growthdayActive ? growthdayQuarter : 'OFF'}</div><div style={styles.summaryLabel}>ê·¸ë¡œìŠ¤ë°ì´</div></div>
          </div>
          <div style={styles.progressSection}><div style={styles.progressHeader}><span>ì „ì²´ ì§„í–‰ë¥ </span><span style={styles.progressPercent}>{stats.overallRate}%</span></div><div style={styles.progressBarBg}><div style={{...styles.progressBarFill, width: stats.overallRate + '%'}} /></div></div>
          <div style={styles.teamSection}><h3 style={styles.sectionTitle}>ë¶€ì„œë³„ í˜„í™©</h3><div style={styles.teamGrid}>{Object.entries(stats.teamStats).map(([team, data]) => <div key={team} style={styles.teamCard}><div style={styles.teamHeader}><div style={{...styles.teamDot, backgroundColor: TEAM_COLORS[team]}} /><span style={styles.teamName}>{team}</span></div><div style={styles.teamStatsRow}><span style={styles.teamUploaded}>{data.uploaded}</span><span style={styles.teamTotal}>/ {data.total}</span></div><div style={styles.teamProgressBg}><div style={{...styles.teamProgressFill, width: data.rate + '%', backgroundColor: TEAM_COLORS[team]}} /></div><div style={styles.teamRate}>{data.rate}%</div></div>)}</div></div>
        </div>
      );
    }

    function MembersTab({ uploadStatus, stats, selectedWeek, setSelectedWeek, onToggle, selectedTeamFilter, setSelectedTeamFilter }) {
      const [year, month, day] = selectedWeek.split('-').map(Number);
      const monday = new Date(year, month - 1, day);
      const sunday = new Date(monday); sunday.setDate(monday.getDate() + 6);
      const selectedWeekLabel = (monday.getMonth()+1) + '/' + monday.getDate() + '~' + (sunday.getMonth()+1) + '/' + sunday.getDate();
      const [isExporting, setIsExporting] = useState(false);

      // ì—…ë¡œë“œ ëŒ€ìƒ ì¸ì›ë§Œ í•„í„°ë§
      const getUploadMembers = (members) => members.filter(m => !EXCLUDED_FROM_UPLOAD.includes(m));

      // PDF ë‚´ë³´ë‚´ê¸°
      const exportMembersPDF = async () => {
        setIsExporting(true);
        
        const today = new Date();
        const dateStr = today.getFullYear() + '-' + String(today.getMonth()+1).padStart(2,'0') + '-' + String(today.getDate()).padStart(2,'0');
        
        // íŒ€ë³„ ë°ì´í„° ì¤€ë¹„
        const teamsData = [];
        Object.entries(REGULAR_TEAMS).filter(([team]) => selectedTeamFilter === 'all' || team === selectedTeamFilter).forEach(([team, members]) => {
          const uploadMembers = getUploadMembers(members);
          if (uploadMembers.length === 0) return;
          const uploadedMembers = uploadMembers.filter(m => uploadStatus[m]?.weeks?.[selectedWeek]);
          const notUploadedMembers = uploadMembers.filter(m => !uploadStatus[m]?.weeks?.[selectedWeek]);
          teamsData.push({ team, uploadMembers, uploadedMembers, notUploadedMembers });
        });
        
        // ì „ì²´ í†µê³„
        const totalMembers = Object.keys(uploadStatus).length;
        const uploadedTotal = Object.values(uploadStatus).filter(s => s.weeks?.[selectedWeek]).length;
        
        // í—¤ë” + í†µê³„ HTML
        const headerHtml = 
          '<div style="text-align: center; margin-bottom: 25px;">' +
            '<h1 style="font-size: 22px; font-weight: 700; color: #191F28; margin-bottom: 6px;">ê·¸ë¡œìŠ¤ë³´ë“œ ì—…ë¡œë“œ í˜„í™©</h1>' +
            '<div style="font-size: 14px; color: #3182F6; font-weight: 600; margin-bottom: 4px;">' + selectedWeekLabel + '</div>' +
            '<div style="font-size: 11px; color: #999;">ìƒì„±ì¼: ' + dateStr + '</div>' +
          '</div>' +
          '<div style="display: flex; justify-content: center; gap: 30px; margin-bottom: 25px; padding: 15px; background: #F7F8FA; border-radius: 10px;">' +
            '<div style="text-align: center;"><div style="font-size: 24px; font-weight: 700; color: #191F28;">' + totalMembers + '</div><div style="font-size: 11px; color: #666;">ì´ ì¸ì›</div></div>' +
            '<div style="text-align: center;"><div style="font-size: 24px; font-weight: 700; color: #00C471;">' + uploadedTotal + '</div><div style="font-size: 11px; color: #666;">ì™„ë£Œ</div></div>' +
            '<div style="text-align: center;"><div style="font-size: 24px; font-weight: 700; color: #E54545;">' + (totalMembers - uploadedTotal) + '</div><div style="font-size: 11px; color: #666;">ë¯¸ì™„ë£Œ</div></div>' +
            '<div style="text-align: center;"><div style="font-size: 24px; font-weight: 700; color: #3182F6;">' + Math.round(uploadedTotal/totalMembers*100) + '%</div><div style="font-size: 11px; color: #666;">ì§„í–‰ë¥ </div></div>' +
          '</div>';
        
        // íŒ€ ì¹´ë“œ HTML ìƒì„± í•¨ìˆ˜
        const createTeamCardHtml = (teamData) => {
          const { team, uploadMembers, uploadedMembers, notUploadedMembers } = teamData;
          let html = '<div style="border: 1px solid #E5E5E5; border-radius: 10px; padding: 12px; margin-bottom: 10px; background: white;">';
          html += '<div style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px solid #F4F4F4;">';
          html += '<div style="width: 10px; height: 10px; border-radius: 50%; background: ' + TEAM_COLORS[team] + ';"></div>';
          html += '<span style="font-size: 13px; font-weight: 700; color: #191F28;">' + team + '</span>';
          html += '<span style="margin-left: auto; font-size: 12px; font-weight: 700; color: ' + (uploadedMembers.length === uploadMembers.length ? '#00C471' : '#E54545') + ';">' + uploadedMembers.length + '/' + uploadMembers.length + '</span>';
          html += '</div>';
          html += '<div style="display: flex; gap: 15px;">';
          // ì™„ë£Œ
          html += '<div style="flex: 1;">';
          html += '<div style="font-size: 10px; color: #00C471; font-weight: 600; margin-bottom: 6px;">âœ“ ì™„ë£Œ (' + uploadedMembers.length + ')</div>';
          if (uploadedMembers.length > 0) {
            html += '<div style="display: flex; flex-wrap: wrap; gap: 4px;">';
            uploadedMembers.forEach(m => { html += '<span style="padding: 3px 8px; background: #E8FFF3; color: #00C471; border-radius: 4px; font-size: 10px;">' + m + '</span>'; });
            html += '</div>';
          } else { html += '<div style="font-size: 10px; color: #999;">-</div>'; }
          html += '</div>';
          // ë¯¸ì™„ë£Œ
          html += '<div style="flex: 1;">';
          html += '<div style="font-size: 10px; color: #E54545; font-weight: 600; margin-bottom: 6px;">âœ• ë¯¸ì™„ë£Œ (' + notUploadedMembers.length + ')</div>';
          if (notUploadedMembers.length > 0) {
            html += '<div style="display: flex; flex-wrap: wrap; gap: 4px;">';
            notUploadedMembers.forEach(m => { html += '<span style="padding: 3px 8px; background: #FEF1F1; color: #E54545; border-radius: 4px; font-size: 10px;">' + m + '</span>'; });
            html += '</div>';
          } else { html += '<div style="font-size: 10px; color: #999;">-</div>'; }
          html += '</div></div></div>';
          return html;
        };
        
        try {
          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('l', 'mm', 'a4');
          const pageWidth = pdf.internal.pageSize.getWidth(); // 297mm
          const pageHeight = pdf.internal.pageSize.getHeight(); // 210mm
          const margin = 10;
          const contentWidth = pageWidth - margin * 2;
          const colWidth = (contentWidth - 10) / 2;
          
          // í—¤ë” ìº¡ì²˜
          const headerDiv = document.createElement('div');
          headerDiv.style.cssText = 'position: absolute; left: -9999px; top: 0; width: 1050px; padding: 20px; background: white; font-family: Pretendard, sans-serif;';
          headerDiv.innerHTML = headerHtml;
          document.body.appendChild(headerDiv);
          
          const headerCanvas = await html2canvas(headerDiv, { scale: 2 });
          const headerImg = headerCanvas.toDataURL('image/png');
          const headerImgHeight = (headerCanvas.height * contentWidth) / headerCanvas.width;
          document.body.removeChild(headerDiv);
          
          // ê° íŒ€ ì¹´ë“œ ìº¡ì²˜
          const teamCards = [];
          for (const teamData of teamsData) {
            const cardDiv = document.createElement('div');
            cardDiv.style.cssText = 'position: absolute; left: -9999px; top: 0; width: 500px; padding: 10px; background: white; font-family: Pretendard, sans-serif;';
            cardDiv.innerHTML = createTeamCardHtml(teamData);
            document.body.appendChild(cardDiv);
            const cardCanvas = await html2canvas(cardDiv, { scale: 2 });
            teamCards.push({
              img: cardCanvas.toDataURL('image/png'),
              width: colWidth,
              height: (cardCanvas.height * colWidth) / cardCanvas.width,
              team: teamData.team
            });
            document.body.removeChild(cardDiv);
          }
          
          // PDFì— ë°°ì¹˜
          let currentPage = 1;
          let yPos = margin;
          
          // í—¤ë” ì¶”ê°€
          pdf.addImage(headerImg, 'PNG', margin, yPos, contentWidth, headerImgHeight);
          yPos += headerImgHeight + 5;
          
          // 2ì—´ ë°°ì¹˜
          let col = 0;
          let colYPos = [yPos, yPos];
          
          for (const card of teamCards) {
            // í˜ì´ì§€ ë„˜ê¹€ ì²´í¬
            if (colYPos[col] + card.height > pageHeight - margin) {
              // ë‹¤ë¥¸ ì—´ í™•ì¸
              const otherCol = col === 0 ? 1 : 0;
              if (colYPos[otherCol] + card.height <= pageHeight - margin) {
                col = otherCol;
              } else {
                // ìƒˆ í˜ì´ì§€
                pdf.addPage();
                currentPage++;
                colYPos = [margin, margin];
                col = 0;
              }
            }
            
            const xPos = margin + col * (colWidth + 10);
            pdf.addImage(card.img, 'PNG', xPos, colYPos[col], card.width, card.height);
            colYPos[col] += card.height + 5;
            
            // ë‹¤ìŒ ì—´ë¡œ
            col = colYPos[0] <= colYPos[1] ? 0 : 1;
          }
          
          // í‘¸í„° ì¶”ê°€
          const totalPages = pdf.internal.getNumberOfPages();
          for (let i = 1; i <= totalPages; i++) {
            pdf.setPage(i);
            pdf.setFontSize(8);
            pdf.setTextColor(153, 153, 153);
            pdf.text('Page ' + i + ' / ' + totalPages, pageWidth / 2, pageHeight - 5, { align: 'center' });
            pdf.text('Netform Growth Board', pageWidth - margin, pageHeight - 5, { align: 'right' });
          }
          
          pdf.save('ê·¸ë¡œìŠ¤ë³´ë“œ_ì—…ë¡œë“œí˜„í™©_' + selectedWeekLabel.replace(/\//g, '-') + '.pdf');
        } catch (err) {
          console.error('PDF ìƒì„± ì˜¤ë¥˜:', err);
          alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        } finally {
          setIsExporting(false);
        }
      };

      // ë¯¸ì—…ë¡œë“œì ë¦¬ìŠ¤íŠ¸ ë³µì‚¬
      const copyMissingList = () => {
        const now = new Date();
        const timeStr = String(now.getHours()).padStart(2, '0') + 'ì‹œ' + String(now.getMinutes()).padStart(2, '0') + 'ë¶„';
        
        let missingByTeam = [];
        Object.entries(REGULAR_TEAMS).filter(([team]) => selectedTeamFilter === 'all' || team === selectedTeamFilter).forEach(([team, members]) => {
          const uploadMembers = getUploadMembers(members);
          if (uploadMembers.length === 0) return;
          const notUploadedMembers = uploadMembers.filter(m => !uploadStatus[m]?.weeks?.[selectedWeek]);
          if (notUploadedMembers.length > 0) {
            missingByTeam.push({ team, members: notUploadedMembers });
          }
        });
        
        if (missingByTeam.length === 0) {
          alert('ë¯¸ì—…ë¡œë“œìê°€ ì—†ìŠµë‹ˆë‹¤! ğŸ‰');
          return;
        }
        
        let text = `ğŸ“‹ ${selectedWeekLabel} ${timeStr} ê¸°ì¤€ ë¯¸ì—…ë¡œë“œì\n`;
        text += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
        
        missingByTeam.forEach(({ team, members }) => {
          text += `â–ªï¸ ${team}\n`;
          members.forEach(m => {
            text += `   - ${m}\n`;
          });
          text += `\n`;
        });
        
        const totalMissing = missingByTeam.reduce((sum, t) => sum + t.members.length, 0);
        text += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
        text += `ì´ ${totalMissing}ëª… ë¯¸ì—…ë¡œë“œ`;
        
        navigator.clipboard.writeText(text).then(() => {
          alert('ë¯¸ì—…ë¡œë“œì ë¦¬ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }).catch(() => {
          // í´ë°±: textarea ì´ìš©
          const textarea = document.createElement('textarea');
          textarea.value = text;
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);
          alert('ë¯¸ì—…ë¡œë“œì ë¦¬ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
        });
      };

      return (
        <div style={styles.page}>
          <div style={styles.pageHeader}>
            <div>
              <h1 style={styles.pageTitle}>ì¸ì› ê´€ë¦¬</h1>
              <p style={styles.pageSubtitle}>ì§ì›ë“¤ì˜ ì—…ë¡œë“œ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ì„¸ìš”</p>
            </div>
            <div style={styles.headerButtons}>
              <button style={styles.copyBtn} onClick={copyMissingList}>ğŸ“‹ ë¯¸ì—…ë¡œë“œì ë³µì‚¬</button>
              <button style={{...styles.pdfExportBtn, opacity: isExporting ? 0.6 : 1}} onClick={exportMembersPDF} disabled={isExporting}>
                {isExporting ? 'â³ ìƒì„± ì¤‘...' : 'ğŸ“„ PDF ë‚´ë³´ë‚´ê¸°'}
              </button>
            </div>
          </div>
          <div style={styles.controlsRow}>
            <WeekCalendar selectedWeek={selectedWeek} setSelectedWeek={setSelectedWeek} uploadStatus={uploadStatus} />
            <select value={selectedTeamFilter} onChange={e => setSelectedTeamFilter(e.target.value)} style={styles.teamFilter}><option value="all">ì „ì²´ ë¶€ì„œ</option>{Object.keys(REGULAR_TEAMS).filter(team => getUploadMembers(REGULAR_TEAMS[team]).length > 0).map(team => <option key={team} value={team}>{team}</option>)}</select>
          </div>
          <div style={styles.selectedWeekBanner}>ğŸ“… ì„ íƒëœ ì£¼: <strong>{selectedWeekLabel}</strong></div>
          
          <div style={styles.memberCardGrid}>
            {Object.entries(REGULAR_TEAMS).filter(([team]) => selectedTeamFilter === 'all' || team === selectedTeamFilter).map(([team, members]) => {
              const uploadMembers = getUploadMembers(members);
              if (uploadMembers.length === 0) return null;
              const uploadedCount = uploadMembers.filter(m => uploadStatus[m]?.weeks?.[selectedWeek]).length;
              
              return (
                <div key={team} style={styles.memberCard}>
                  <div style={styles.memberCardHeader}>
                    <div style={{...styles.memberCardDot, backgroundColor: TEAM_COLORS[team]}} />
                    <span style={styles.memberCardTeam}>{team}</span>
                    <span style={{...styles.memberCardCount, color: uploadedCount === uploadMembers.length ? '#00C471' : '#E54545'}}>
                      {uploadedCount}/{uploadMembers.length}
                    </span>
                  </div>
                  
                  <div style={styles.memberListInCard}>
                    {uploadMembers.map(member => {
                      const isUploaded = uploadStatus[member]?.weeks?.[selectedWeek];
                      return (
                        <div key={member} style={{...styles.memberItemInCard, backgroundColor: isUploaded ? '#F0FDF4' : '#FEF2F2'}}>
                          <span style={{...styles.memberNameInCard, color: isUploaded ? '#166534' : '#991B1B'}}>{member}</span>
                          <button 
                            style={{...styles.statusToggleBtn, backgroundColor: isUploaded ? '#22C55E' : '#EF4444'}}
                            onClick={() => onToggle(member, selectedWeek)}
                          >
                            {isUploaded ? 'âœ“' : 'âœ•'}
                          </button>
                        </div>
                      );
                    })}
                  </div>
                  
                  <div style={styles.memberCardProgress}>
                    <div style={{...styles.memberCardProgressFill, width: (uploadedCount / uploadMembers.length * 100) + '%', backgroundColor: TEAM_COLORS[team]}} />
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      );
    }

    function GrowthdayTab({ growthdayActive, growthdayQuarter, growthdayStats, scores, onStartClick, onStop, onDeleteScore, onUpdateScore }) {
      const [selectedPresenter, setSelectedPresenter] = useState(null);
      const [isExporting, setIsExporting] = useState(false);
      const [editingVoter, setEditingVoter] = useState(null);
      const [editScores, setEditScores] = useState({});
      const [selectedViewQuarter, setSelectedViewQuarter] = useState('');
      
      // scoresì—ì„œ ëª¨ë“  ë¶„ê¸° ëª©ë¡ ì¶”ì¶œ (ìµœì‹ ìˆœ ì •ë ¬)
      const allQuarters = Object.keys(scores || {}).sort((a, b) => {
        const parseQuarter = (q) => {
          const match = q.match(/(\d+)ë…„\s*(\d+)ë¶„ê¸°/);
          if (match) return parseInt(match[1]) * 10 + parseInt(match[2]);
          return 0;
        };
        return parseQuarter(b) - parseQuarter(a);
      });
      
      // ì´ˆê¸°ê°’ ì„¤ì •: í˜„ì¬ í™œì„±í™”ëœ ë¶„ê¸° ë˜ëŠ” ì²« ë²ˆì§¸ ë¶„ê¸°
      React.useEffect(() => {
        if (!selectedViewQuarter && allQuarters.length > 0) {
          setSelectedViewQuarter(growthdayQuarter || allQuarters[0]);
        }
      }, [allQuarters, growthdayQuarter]);
      
      // ì„ íƒëœ ë¶„ê¸°ì˜ í†µê³„ ê³„ì‚° (ìµœê³ /ìµœì €ì  ì œì™¸ ë¡œì§ í¬í•¨)
      const getQuarterStats = (quarter) => {
        const quarterScores = scores[quarter] || {};
        const results = [];
        Object.entries(quarterScores).forEach(([presenter, voters]) => {
          const voterList = Object.entries(voters);
          if (voterList.length === 0) return;
          
          const voterDetails = [];
          const ceoVoters = [];
          const regularVoters = [];
          
          voterList.forEach(([voter, data]) => {
            const baseScore = Object.values(data.scores).reduce((a, b) => a + b, 0);
            const finalScore = data.isCEO ? baseScore * 2 : baseScore;
            const voterTeam = Object.entries(TEAMS_DATA).find(([t, members]) => members.includes(voter))?.[0] || '';
            const voterData = { name: voter, team: voterTeam, baseScore, finalScore, isCEO: data.isCEO };
            voterDetails.push(voterData);
            
            if (data.isCEO) {
              ceoVoters.push(voterData);
            } else {
              regularVoters.push(voterData);
            }
          });
          
          let filteredRegularVoters = [...regularVoters];
          let excludedVoters = [];
          if (regularVoters.length >= 3) {
            const sorted = [...regularVoters].sort((a, b) => a.finalScore - b.finalScore);
            const minVoter = sorted[0];
            const maxVoter = sorted[sorted.length - 1];
            excludedVoters = [minVoter.name, maxVoter.name];
            filteredRegularVoters = regularVoters.filter(v => v.name !== minVoter.name && v.name !== maxVoter.name);
          }
          
          const countedVoters = [...ceoVoters, ...filteredRegularVoters];
          const totalScore = countedVoters.reduce((sum, v) => sum + v.finalScore, 0);
          const averageScore = countedVoters.length > 0 ? totalScore / countedVoters.length : 0;
          
          const team = Object.entries(TEAMS_DATA).find(([t, members]) => members.includes(presenter))?.[0] || '';
          results.push({ 
            name: presenter, 
            team, 
            voterCount: voterList.length, 
            countedVoterCount: countedVoters.length,
            averageScore: averageScore.toFixed(1), 
            ceoVoted: ceoVoters.length > 0, 
            voterDetails: voterDetails.map(v => ({...v, excluded: excludedVoters.includes(v.name)})), 
            totalScore,
            excludedVoters
          });
        });
        return results.sort((a, b) => parseFloat(b.averageScore) - parseFloat(a.averageScore));
      };
      
      const viewStats = selectedViewQuarter ? getQuarterStats(selectedViewQuarter) : [];
      const selectedData = viewStats.find(r => r.name === selectedPresenter);

      const SCORING_CRITERIA = [
        { id: 'goal', name: 'ëª©í‘œì™€ ì„±ê³¼', maxScore: 30 },
        { id: 'growth', name: 'ê°œì¸ ì„±ì¥', maxScore: 20 },
        { id: 'learning', name: 'í•™ìŠµ/ì‹¤íŒ¨ ê³µìœ ', maxScore: 20 },
        { id: 'collaboration', name: 'í˜‘ì—…ê³¼ ê¸°ì—¬', maxScore: 15 },
        { id: 'presentation', name: 'ë°œí‘œë ¥', maxScore: 15 },
      ];

      const openEditModal = (presenter, voter) => {
        const voterData = scores[selectedViewQuarter]?.[presenter]?.[voter];
        if (voterData) {
          setEditScores(voterData.scores || {});
          setEditingVoter({ presenter, voter, isCEO: voterData.isCEO, quarter: selectedViewQuarter });
        }
      };

      const handleSaveEdit = () => {
        if (editingVoter) {
          onUpdateScore(editingVoter.presenter, editingVoter.voter, editScores, editingVoter.isCEO, editingVoter.quarter);
          setEditingVoter(null);
          setEditScores({});
        }
      };

      const exportToPDF = async () => {
        setIsExporting(true);
        
        // PDFìš© ì„ì‹œ DOM ìš”ì†Œ ìƒì„±
        const pdfContent = document.createElement('div');
        pdfContent.style.cssText = 'position: absolute; left: -9999px; top: 0; width: 800px; padding: 40px; background: white; font-family: Pretendard, sans-serif;';
        
        const today = new Date();
        const dateStr = today.getFullYear() + '-' + String(today.getMonth()+1).padStart(2,'0') + '-' + String(today.getDate()).padStart(2,'0');
        
        pdfContent.innerHTML = `
          <div style="text-align: center; margin-bottom: 30px;">
            <h1 style="font-size: 28px; font-weight: 700; color: #191F28; margin-bottom: 8px;">ê·¸ë¡œìŠ¤ë°ì´ ì ìˆ˜ ë¦¬í¬íŠ¸</h1>
            <div style="font-size: 18px; color: #3182F6; font-weight: 600; margin-bottom: 4px;">${selectedViewQuarter}</div>
            <div style="font-size: 12px; color: #999;">ìƒì„±ì¼: ${dateStr}</div>
          </div>
          <div style="border-top: 2px solid #E5E5E5; padding-top: 20px; margin-bottom: 20px;">
            <div style="font-size: 14px; color: #333; margin-bottom: 15px;">ì´ ë°œí‘œì: <strong>${viewStats.length}ëª…</strong> (ìµœê³ /ìµœì €ì  ì œì™¸ í›„ í‰ê· )</div>
          </div>
          <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
            <thead>
              <tr style="background: #F7F8FA;">
                <th style="padding: 12px 8px; text-align: center; color: #666; font-weight: 600; width: 60px;">ìˆœìœ„</th>
                <th style="padding: 12px 8px; text-align: left; color: #666; font-weight: 600;">ì´ë¦„</th>
                <th style="padding: 12px 8px; text-align: left; color: #666; font-weight: 600;">ì†Œì†</th>
                <th style="padding: 12px 8px; text-align: center; color: #666; font-weight: 600; width: 80px;">ë°˜ì˜ì¸ì›</th>
                <th style="padding: 12px 8px; text-align: center; color: #666; font-weight: 600; width: 80px;">í‰ê· ì ìˆ˜</th>
              </tr>
            </thead>
            <tbody>
              ${viewStats.map((result, index) => {
                const rankStyle = index === 0 ? 'background: #FFD700; color: white;' 
                  : index === 1 ? 'background: #C0C0C0; color: white;' 
                  : index === 2 ? 'background: #CD7F32; color: white;' : 'background: #F4F4F4; color: #666;';
                return `
                  <tr style="border-bottom: 1px solid #F4F4F4;">
                    <td style="padding: 14px 8px; text-align: center;">
                      <span style="display: inline-block; width: 28px; height: 28px; line-height: 28px; border-radius: 50%; font-weight: 700; font-size: 12px; ${rankStyle}">${index + 1}</span>
                    </td>
                    <td style="padding: 14px 8px; font-weight: 600; color: #191F28;">${result.name}</td>
                    <td style="padding: 14px 8px; color: #666;">${result.team}</td>
                    <td style="padding: 14px 8px; text-align: center; color: #666;">${result.countedVoterCount}ëª… ${result.ceoVoted ? 'â­' : ''}</td>
                    <td style="padding: 14px 8px; text-align: center; font-weight: 700; color: #3182F6; font-size: 16px;">${result.averageScore}</td>
                  </tr>
                `;
              }).join('')}
            </tbody>
          </table>
          <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #E5E5E5;">
            <div style="font-size: 11px; color: #999;">â­ ëŒ€í‘œì´ì‚¬ í‰ê°€ (x2 ë°°ì  ì ìš©) Â· ìµœê³ ì /ìµœì €ì  ê° 1ê°œ ì œì™¸</div>
            <div style="font-size: 11px; color: #999; margin-top: 4px;">Netform Growth Board</div>
          </div>
        `;
        
        document.body.appendChild(pdfContent);
        
        try {
          const canvas = await html2canvas(pdfContent, { scale: 2, useCORS: true });
          const imgData = canvas.toDataURL('image/png');
          
          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const pdfWidth = pdf.internal.pageSize.getWidth();
          const pdfHeight = pdf.internal.pageSize.getHeight();
          const imgWidth = pdfWidth - 20;
          const imgHeight = (canvas.height * imgWidth) / canvas.width;
          
          let heightLeft = imgHeight;
          let position = 10;
          
          pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
          heightLeft -= (pdfHeight - 20);
          
          while (heightLeft > 0) {
            position = heightLeft - imgHeight + 10;
            pdf.addPage();
            pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
            heightLeft -= (pdfHeight - 20);
          }
          
          const fileName = 'ê·¸ë¡œìŠ¤ë°ì´_' + selectedViewQuarter.replace(/\s/g, '_') + '_' + dateStr + '.pdf';
          pdf.save(fileName);
        } catch (err) {
          console.error('PDF ìƒì„± ì˜¤ë¥˜:', err);
          alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        } finally {
          document.body.removeChild(pdfContent);
          setIsExporting(false);
        }
      };

      return (
        <div style={styles.page}>
          <div style={styles.pageHeader}><h1 style={styles.pageTitle}>ê·¸ë¡œìŠ¤ë°ì´ ê´€ë¦¬</h1><p style={styles.pageSubtitle}>ê·¸ë¡œìŠ¤ë°ì´ í™œì„±í™” ë° ì ìˆ˜ í˜„í™©ì„ ê´€ë¦¬í•˜ì„¸ìš”</p></div>
          <div style={styles.growthdayControlCard}>
            <div style={styles.growthdayControlHeader}><div><div style={styles.growthdayControlTitle}>ê·¸ë¡œìŠ¤ë°ì´ ë°°ì </div><div style={styles.growthdayControlDesc}>{growthdayActive ? growthdayQuarter + ' ë°°ì ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤' : 'ìƒˆë¡œìš´ ê·¸ë¡œìŠ¤ë°ì´ë¥¼ ì‹œì‘í•˜ì„¸ìš”'}</div></div>{growthdayActive ? <button style={styles.stopBtn} onClick={onStop}>ì¢…ë£Œí•˜ê¸°</button> : <button style={styles.startBtn} onClick={onStartClick}>ì‹œì‘í•˜ê¸°</button>}</div>
            <div style={{...styles.statusBanner, backgroundColor: growthdayActive ? '#E8FFF3' : '#F4F4F4', color: growthdayActive ? '#00C471' : '#666'}}><div style={{...styles.statusDot, backgroundColor: growthdayActive ? '#00C471' : '#999'}} />{growthdayActive ? growthdayQuarter + ' ê·¸ë¡œìŠ¤ë°ì´ ë°°ì ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤' : 'ê·¸ë¡œìŠ¤ë°ì´ ë°°ì ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤'}</div>
          </div>
          <div style={styles.scoreInfoCard}>â­ ëŒ€í‘œì´ì‚¬ë‹˜ì˜ ë°°ì ì€ <strong>2ë°°</strong>ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤ (ìµœëŒ€ 200ì ) Â· ìµœê³ ì /ìµœì €ì  ê° 1ê°œ ì œì™¸</div>
          
          {/* ë¶„ê¸° ì„ íƒ ë° ì ìˆ˜ í˜„í™© - í•­ìƒ í‘œì‹œ */}
          <div style={styles.scoresSection}>
            <div style={styles.scoresSectionHeader}>
              <div style={{display: 'flex', alignItems: 'center', gap: '16px'}}>
                <h3 style={styles.sectionTitle}>ì ìˆ˜ í˜„í™©</h3>
                <select 
                  value={selectedViewQuarter} 
                  onChange={(e) => { setSelectedViewQuarter(e.target.value); setSelectedPresenter(null); }}
                  style={{padding: '10px 16px', border: '1px solid #E5E5E5', borderRadius: '8px', fontSize: '14px', fontWeight: '600', backgroundColor: '#FFF', cursor: 'pointer', color: '#191F28'}}
                >
                  {allQuarters.length === 0 ? (
                    <option value="">ë°ì´í„° ì—†ìŒ</option>
                  ) : (
                    allQuarters.map(q => (
                      <option key={q} value={q}>{q} {q === growthdayQuarter && growthdayActive ? '(ì§„í–‰ì¤‘)' : ''}</option>
                    ))
                  )}
                </select>
                <span style={styles.scoreCount}>{viewStats.length}ëª… ë°œí‘œ</span>
              </div>
              {viewStats.length > 0 && <button style={{...styles.pdfExportBtn, opacity: isExporting ? 0.6 : 1}} onClick={exportToPDF} disabled={isExporting}>{isExporting ? 'â³ ìƒì„± ì¤‘...' : 'ğŸ“„ PDF ë‚´ë³´ë‚´ê¸°'}</button>}
            </div>
            {allQuarters.length === 0 ? (
              <div style={styles.emptyState}>ì•„ì§ ë°°ì ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</div>
            ) : viewStats.length === 0 ? (
              <div style={styles.emptyState}>ì„ íƒëœ ë¶„ê¸°ì— ë°°ì ëœ ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤</div>
            ) : (
              <div style={styles.scoresList}>
                {viewStats.map((result, index) => (
                  <div key={result.name} style={styles.scoreCard} onClick={() => setSelectedPresenter(result.name)}>
                    <div style={styles.scoreRank}>{index < 3 ? <div style={{...styles.rankBadge, backgroundColor: index === 0 ? '#FFD700' : index === 1 ? '#C0C0C0' : '#CD7F32'}}>{index + 1}</div> : <span style={styles.rankNumber}>{index + 1}</span>}</div>
                    <div style={{...styles.scoreAvatar, backgroundColor: TEAM_COLORS[result.team]}}>{result.name[0]}</div>
                    <div style={styles.scoreInfo}><div style={styles.scoreName}>{result.name}</div><div style={styles.scoreTeam}>{result.team}</div></div>
                    <div style={styles.scoreVoters}>{result.countedVoterCount}ëª… ë°˜ì˜ {result.ceoVoted && 'â­'}</div>
                    <div style={styles.scoreTotalValue}><span style={styles.scoreNumber}>{result.averageScore}</span><span style={styles.scoreUnit}>ì </span></div>
                    <span style={styles.detailArrow}>â†’</span>
                  </div>
                ))}
              </div>
            )}
          </div>
          {selectedPresenter && selectedData && (
            <div style={styles.modalOverlay} onClick={() => setSelectedPresenter(null)}>
              <div style={styles.modal} onClick={e => e.stopPropagation()}>
                <div style={styles.modalHeader}><h3 style={styles.modalTitle}><div style={{...styles.modalAvatar, backgroundColor: TEAM_COLORS[selectedData.team]}}>{selectedData.name[0]}</div>{selectedData.name} ì ìˆ˜ ìƒì„¸</h3><button style={styles.modalClose} onClick={() => setSelectedPresenter(null)}>âœ•</button></div>
                <div style={styles.modalSubtitle}>{selectedData.team} Â· í‰ê·  {selectedData.averageScore}ì  ({selectedData.countedVoterCount}ëª… ë°˜ì˜) Â· {selectedViewQuarter}</div>
                {selectedData.excludedVoters?.length > 0 && (
                  <div style={{padding: '10px 14px', backgroundColor: '#FFF8E6', borderRadius: '8px', marginBottom: '12px', fontSize: '13px', color: '#B8860B'}}>
                    âš ï¸ ìµœê³ ì /ìµœì €ì  ì œì™¸: {selectedData.excludedVoters.join(', ')}
                  </div>
                )}
                <div style={styles.voterList}>
                  {selectedData.voterDetails.map(voter => (
                    <div key={voter.name} style={{...styles.voterItem, opacity: voter.excluded ? 0.5 : 1, backgroundColor: voter.excluded ? '#F9F9F9' : 'transparent'}}>
                      <div style={styles.voterInfo}>
                        <div style={{...styles.voterAvatar, backgroundColor: TEAM_COLORS[voter.team]}}>{voter.name[0]}</div>
                        <div>
                          <div style={styles.voterName}>
                            {voter.name}
                            {voter.isCEO && <span style={styles.ceoBadgeSmall}>x2</span>}
                            {voter.excluded && <span style={{marginLeft: '6px', padding: '2px 6px', backgroundColor: '#FFE066', borderRadius: '4px', fontSize: '10px', fontWeight: '600', color: '#8B6914'}}>ì œì™¸</span>}
                          </div>
                          <div style={styles.voterTeam}>{voter.team}</div>
                        </div>
                      </div>
                      <div style={{display: 'flex', alignItems: 'center', gap: '12px'}}>
                        <div style={styles.voterScoreBox}><span style={{...styles.voterScore, textDecoration: voter.excluded ? 'line-through' : 'none'}}>{voter.finalScore}</span><span style={styles.voterScoreUnit}>ì </span></div>
                        <button style={{padding: '6px 10px', border: '1px solid #3182F6', backgroundColor: '#E8F3FF', borderRadius: '6px', fontSize: '12px', fontWeight: '600', color: '#3182F6', cursor: 'pointer'}} onClick={() => openEditModal(selectedData.name, voter.name)}>ìˆ˜ì •</button>
                        <button style={{padding: '6px 10px', border: '1px solid #E54545', backgroundColor: '#FEF1F1', borderRadius: '6px', fontSize: '12px', fontWeight: '600', color: '#E54545', cursor: 'pointer'}} onClick={() => onDeleteScore(selectedData.name, voter.name, selectedViewQuarter)}>ì‚­ì œ</button>
                      </div>
                    </div>
                  ))}
                </div>
                <div style={styles.totalSummary}><span>í‰ê·  ì ìˆ˜ ({selectedData.countedVoterCount}ëª… ë°˜ì˜)</span><span style={styles.totalSummaryValue}>{selectedData.averageScore}ì </span></div>
              </div>
            </div>
          )}
          {editingVoter && (
            <div style={styles.modalOverlay} onClick={() => setEditingVoter(null)}>
              <div style={{...styles.modal, maxWidth: '400px'}} onClick={e => e.stopPropagation()}>
                <div style={styles.modalHeader}><h3 style={styles.modalTitle}>ì ìˆ˜ ìˆ˜ì •</h3><button style={styles.modalClose} onClick={() => setEditingVoter(null)}>âœ•</button></div>
                <div style={styles.modalSubtitle}>{editingVoter.voter}ë‹˜ì´ {editingVoter.presenter}ë‹˜ì—ê²Œ ì¤€ ì ìˆ˜</div>
                <div style={{display: 'flex', flexDirection: 'column', gap: '12px', marginTop: '16px'}}>
                  {SCORING_CRITERIA.map(criteria => (
                    <div key={criteria.id} style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', backgroundColor: '#F7F8FA', borderRadius: '8px'}}>
                      <div><div style={{fontSize: '14px', fontWeight: '600', color: '#191F28'}}>{criteria.name}</div><div style={{fontSize: '12px', color: '#666'}}>ìµœëŒ€ {criteria.maxScore}ì </div></div>
                      <input type="number" min="0" max={criteria.maxScore} value={editScores[criteria.id] || 0} onChange={e => setEditScores({...editScores, [criteria.id]: Math.min(criteria.maxScore, Math.max(0, parseInt(e.target.value) || 0))})} style={{width: '70px', padding: '8px 12px', border: '1px solid #E5E5E5', borderRadius: '6px', fontSize: '16px', fontWeight: '600', textAlign: 'center'}} />
                    </div>
                  ))}
                </div>
                <div style={{padding: '16px', backgroundColor: '#E8F3FF', borderRadius: '10px', marginTop: '16px', textAlign: 'center'}}>
                  <span style={{fontSize: '14px', color: '#3182F6'}}>ì´ì : </span>
                  <span style={{fontSize: '20px', fontWeight: '700', color: '#3182F6'}}>{Object.values(editScores).reduce((a, b) => a + b, 0)}</span>
                  <span style={{fontSize: '14px', color: '#3182F6'}}>ì  {editingVoter.isCEO && '(x2 = ' + (Object.values(editScores).reduce((a, b) => a + b, 0) * 2) + 'ì )'}</span>
                </div>
                <div style={styles.modalActions}>
                  <button style={styles.cancelBtn} onClick={() => setEditingVoter(null)}>ì·¨ì†Œ</button>
                  <button style={styles.confirmBtn} onClick={handleSaveEdit}>ì €ì¥</button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    const styles = {
      container: { minHeight: '100vh', backgroundColor: '#F7F8FA' },
      toast: { position: 'fixed', top: '24px', left: '50%', transform: 'translateX(-50%)', backgroundColor: '#FFF', padding: '12px 24px', borderRadius: '12px', boxShadow: '0 4px 20px rgba(0,0,0,0.15)', fontSize: '14px', fontWeight: '500', zIndex: 1000 },
      loginScreen: { minHeight: '100vh', backgroundColor: '#F7F8FA', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '20px' },
      loginCard: { backgroundColor: '#FFF', borderRadius: '24px', padding: '40px', width: '100%', maxWidth: '400px', boxShadow: '0 4px 24px rgba(0,0,0,0.08)' },
      loginHeader: { textAlign: 'center', marginBottom: '32px' },
      loginTitle: { fontSize: '24px', fontWeight: '700', color: '#191F28', marginBottom: '8px' },
      loginSubtitle: { fontSize: '15px', color: '#666' },
      inputGroup: { marginBottom: '20px' },
      inputLabel: { display: 'block', fontSize: '14px', fontWeight: '600', color: '#333', marginBottom: '8px' },
      input: { width: '100%', padding: '14px 16px', border: '1px solid #E5E5E5', borderRadius: '10px', fontSize: '15px', outline: 'none' },
      errorText: { color: '#E54545', fontSize: '13px', marginBottom: '16px' },
      loginBtn: { width: '100%', padding: '16px', border: 'none', backgroundColor: '#191F28', borderRadius: '12px', fontSize: '16px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      modalOverlay: { position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000 },
      modal: { backgroundColor: '#FFF', borderRadius: '20px', padding: '28px', width: '100%', maxWidth: '480px', maxHeight: '80vh', overflow: 'auto', margin: '20px' },
      modalHeader: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' },
      modalTitle: { fontSize: '20px', fontWeight: '700', color: '#191F28', display: 'flex', alignItems: 'center', gap: '10px' },
      modalCount: { padding: '4px 10px', backgroundColor: '#FEF1F1', color: '#E54545', borderRadius: '6px', fontSize: '14px', fontWeight: '600' },
      modalSubtitle: { fontSize: '14px', color: '#666', marginBottom: '20px' },
      modalClose: { background: 'none', border: 'none', cursor: 'pointer', fontSize: '20px', color: '#666' },
      modalActions: { display: 'flex', gap: '12px', marginTop: '24px' },
      cancelBtn: { flex: 1, padding: '14px', border: '1px solid #E5E5E5', backgroundColor: '#FFF', borderRadius: '10px', fontSize: '15px', fontWeight: '600', color: '#666', cursor: 'pointer' },
      confirmBtn: { flex: 1, padding: '14px', border: 'none', backgroundColor: '#3182F6', borderRadius: '10px', fontSize: '15px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      selectGroup: { marginBottom: '20px' },
      selectLabel: { display: 'block', fontSize: '14px', fontWeight: '600', color: '#333', marginBottom: '10px' },
      selectButtons: { display: 'flex', gap: '8px', flexWrap: 'wrap' },
      selectBtn: { padding: '12px 20px', border: '1px solid #E5E5E5', backgroundColor: '#FFF', borderRadius: '10px', fontSize: '15px', fontWeight: '500', color: '#666', cursor: 'pointer' },
      selectBtnActive: { backgroundColor: '#3182F6', borderColor: '#3182F6', color: '#FFF' },
      previewBanner: { padding: '16px', backgroundColor: '#E8F3FF', borderRadius: '10px', fontSize: '14px', color: '#3182F6', marginTop: '8px' },
      missingList: { maxHeight: '300px', overflowY: 'auto' },
      emptyMissing: { textAlign: 'center', padding: '40px 20px', color: '#00C471', fontSize: '15px', fontWeight: '500' },
      missingTeamGroup: { marginBottom: '16px' },
      missingTeamHeader: { display: 'flex', alignItems: 'center', gap: '8px', padding: '10px 0', fontSize: '14px', fontWeight: '600', color: '#191F28', borderBottom: '1px solid #F4F4F4' },
      teamDot: { width: '10px', height: '10px', borderRadius: '50%' },
      missingTeamCount: { marginLeft: 'auto', color: '#E54545', fontSize: '13px' },
      missingMembers: { padding: '8px 0' },
      missingMember: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '10px 0', fontSize: '14px', color: '#333' },
      quickCheckBtn: { padding: '6px 12px', border: '1px solid #3182F6', backgroundColor: '#E8F3FF', borderRadius: '6px', fontSize: '12px', fontWeight: '600', color: '#3182F6', cursor: 'pointer' },
      header: { backgroundColor: '#191F28', position: 'sticky', top: 0, zIndex: 100 },
      headerContent: { maxWidth: '1400px', margin: '0 auto', padding: '16px 24px', display: 'flex', alignItems: 'center', justifyContent: 'space-between' },
      logo: { display: 'flex', alignItems: 'center', gap: '12px' },
      logoText: { fontSize: '20px', fontWeight: '700', color: '#FFF' },
      adminBadge: { padding: '4px 10px', backgroundColor: '#3182F6', borderRadius: '4px', fontSize: '12px', fontWeight: '600', color: '#FFF' },
      nav: { display: 'flex', gap: '8px' },
      navButton: { padding: '10px 20px', border: 'none', backgroundColor: 'transparent', borderRadius: '8px', fontSize: '14px', fontWeight: '500', color: '#999', cursor: 'pointer' },
      navButtonActive: { backgroundColor: 'rgba(49,130,246,0.2)', color: '#3182F6' },
      logoutBtn: { padding: '10px 16px', border: '1px solid #444', backgroundColor: 'transparent', borderRadius: '8px', fontSize: '13px', fontWeight: '500', color: '#999', cursor: 'pointer' },
      main: { maxWidth: '1400px', margin: '0 auto', padding: '32px 24px' },
      page: {},
      pageHeader: { marginBottom: '28px', display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' },
      pageTitle: { fontSize: '28px', fontWeight: '700', color: '#191F28', marginBottom: '8px' },
      pageSubtitle: { fontSize: '16px', color: '#666' },
      calendarContainer: { backgroundColor: '#FFF', borderRadius: '16px', padding: '24px', marginBottom: '24px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      calendarHeader: { display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '16px', marginBottom: '20px' },
      calendarNavBtn: { width: '36px', height: '36px', border: '1px solid #E5E5E5', backgroundColor: '#FFF', borderRadius: '8px', fontSize: '14px', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center' },
      calendarTitle: { fontSize: '18px', fontWeight: '700', color: '#191F28', minWidth: '140px', textAlign: 'center' },
      todayBtn: { padding: '8px 16px', border: '1px solid #3182F6', backgroundColor: '#E8F3FF', borderRadius: '8px', fontSize: '13px', fontWeight: '600', color: '#3182F6', cursor: 'pointer', marginLeft: '8px' },
      calendarDayNames: { display: 'grid', gridTemplateColumns: 'repeat(7, 1fr) 60px', gap: '4px', marginBottom: '8px' },
      calendarDayName: { textAlign: 'center', fontSize: '12px', fontWeight: '600', color: '#999', padding: '8px 0' },
      calendarBody: {},
      calendarWeekRow: { display: 'grid', gridTemplateColumns: 'repeat(7, 1fr) 60px', gap: '4px', padding: '8px 4px', borderRadius: '8px', marginBottom: '4px', transition: 'all 0.2s' },
      calendarWeekRowSelected: { backgroundColor: '#E8F3FF', boxShadow: '0 0 0 2px #3182F6' },
      calendarDay: { textAlign: 'center', fontSize: '14px', fontWeight: '500', color: '#191F28', padding: '8px 0' },
      calendarDayOtherMonth: { color: '#CCC' },
      calendarDayToday: { backgroundColor: '#3182F6', color: '#FFF', borderRadius: '50%', width: '28px', height: '28px', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto' },
      calendarDayWeekend: { color: '#E54545' },
      weekUploadRate: { fontSize: '12px', fontWeight: '700', textAlign: 'center', display: 'flex', alignItems: 'center', justifyContent: 'center' },
      calendarLegend: { display: 'flex', justifyContent: 'center', gap: '20px', marginTop: '16px', paddingTop: '16px', borderTop: '1px solid #F4F4F4' },
      legendItem: { display: 'flex', alignItems: 'center', gap: '6px', fontSize: '12px', color: '#666' },
      legendDot: { width: '8px', height: '8px', borderRadius: '50%' },
      selectedWeekBanner: { padding: '16px 20px', backgroundColor: '#E8F3FF', borderRadius: '12px', marginBottom: '24px', fontSize: '15px', color: '#3182F6' },
      summaryGrid: { display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '16px', marginBottom: '24px' },
      summaryCard: { backgroundColor: '#FFF', borderRadius: '16px', padding: '24px', textAlign: 'center', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      summaryValue: { fontSize: '32px', fontWeight: '700', color: '#191F28', marginBottom: '4px' },
      summaryLabel: { fontSize: '14px', color: '#666' },
      clickHint: { fontSize: '12px', color: '#3182F6', marginTop: '8px' },
      progressSection: { backgroundColor: '#FFF', borderRadius: '16px', padding: '24px', marginBottom: '24px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      progressHeader: { display: 'flex', justifyContent: 'space-between', marginBottom: '12px', fontSize: '14px', fontWeight: '500' },
      progressPercent: { color: '#3182F6', fontWeight: '700' },
      progressBarBg: { height: '12px', backgroundColor: '#E5E5E5', borderRadius: '6px', overflow: 'hidden' },
      progressBarFill: { height: '100%', backgroundColor: '#3182F6', borderRadius: '6px', transition: 'width 0.5s ease' },
      teamSection: { marginBottom: '24px' },
      sectionTitle: { fontSize: '18px', fontWeight: '600', color: '#191F28', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '12px' },
      teamGrid: { display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '16px' },
      teamCard: { backgroundColor: '#FFF', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      teamHeader: { display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px' },
      teamName: { fontSize: '14px', fontWeight: '600', color: '#191F28' },
      teamStatsRow: { marginBottom: '8px' },
      teamUploaded: { fontSize: '24px', fontWeight: '700', color: '#191F28' },
      teamTotal: { fontSize: '16px', color: '#666' },
      teamProgressBg: { height: '6px', backgroundColor: '#E5E5E5', borderRadius: '3px', overflow: 'hidden', marginBottom: '8px' },
      teamProgressFill: { height: '100%', borderRadius: '3px' },
      teamRate: { fontSize: '13px', fontWeight: '600', color: '#666', textAlign: 'right' },
      controlsRow: { marginBottom: '24px' },
      teamFilter: { padding: '10px 16px', border: '1px solid #E5E5E5', borderRadius: '8px', fontSize: '14px', backgroundColor: '#FFF', cursor: 'pointer', marginTop: '16px' },
      memberSection: {},
      memberTeamGroup: { backgroundColor: '#FFF', borderRadius: '12px', marginBottom: '12px', overflow: 'hidden', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      memberTeamHeader: { display: 'flex', alignItems: 'center', gap: '8px', padding: '16px 20px', backgroundColor: '#F7F8FA', fontSize: '14px', fontWeight: '600', color: '#191F28' },
      memberTeamCount: { marginLeft: 'auto', color: '#666', fontWeight: '500' },
      memberList: { padding: '12px 20px' },
      memberItem: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px 0', borderBottom: '1px solid #F4F4F4' },
      memberName: { fontSize: '14px', color: '#333', fontWeight: '500' },
      memberToggle: { padding: '6px 12px', border: '1px solid', borderRadius: '6px', fontSize: '13px', fontWeight: '600', cursor: 'pointer' },
      // ì¹´ë“œ ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼
      memberCardGrid: { display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(280px, 1fr))', gap: '16px' },
      memberCard: { backgroundColor: '#FFF', borderRadius: '16px', padding: '20px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)' },
      memberCardHeader: { display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '16px' },
      memberCardDot: { width: '12px', height: '12px', borderRadius: '50%' },
      memberCardTeam: { fontSize: '15px', fontWeight: '700', color: '#191F28', flex: 1 },
      memberCardCount: { fontSize: '14px', fontWeight: '700' },
      notUploadedSection: { marginBottom: '12px' },
      notUploadedLabel: { fontSize: '12px', color: '#E54545', fontWeight: '600', marginBottom: '8px' },
      notUploadedList: { display: 'flex', flexDirection: 'column', gap: '8px' },
      notUploadedItem: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '10px 12px', backgroundColor: '#FEF1F1', borderRadius: '8px' },
      notUploadedName: { fontSize: '14px', fontWeight: '500', color: '#E54545' },
      quickCompleteBtn: { padding: '5px 12px', border: 'none', backgroundColor: '#E54545', borderRadius: '6px', fontSize: '12px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      allCompleteMessage: { textAlign: 'center', padding: '20px', color: '#00C471', fontSize: '15px', fontWeight: '600' },
      memberCardProgress: { height: '6px', backgroundColor: '#E5E5E5', borderRadius: '3px', overflow: 'hidden', marginTop: '12px' },
      memberCardProgressFill: { height: '100%', borderRadius: '3px', transition: 'width 0.3s ease' },
      memberListInCard: { display: 'flex', flexDirection: 'column', gap: '6px', marginBottom: '12px' },
      memberItemInCard: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '8px 12px', borderRadius: '8px' },
      memberNameInCard: { fontSize: '13px', fontWeight: '500' },
      statusToggleBtn: { width: '28px', height: '28px', border: 'none', borderRadius: '6px', color: '#FFF', fontSize: '14px', fontWeight: '700', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center' },
      growthdayControlCard: { backgroundColor: '#FFF', borderRadius: '16px', padding: '28px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)', marginBottom: '16px' },
      growthdayControlHeader: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' },
      growthdayControlTitle: { fontSize: '18px', fontWeight: '600', color: '#191F28', marginBottom: '4px' },
      growthdayControlDesc: { fontSize: '14px', color: '#666' },
      startBtn: { padding: '12px 24px', border: 'none', backgroundColor: '#3182F6', borderRadius: '10px', fontSize: '15px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      stopBtn: { padding: '12px 24px', border: 'none', backgroundColor: '#E54545', borderRadius: '10px', fontSize: '15px', fontWeight: '600', color: '#FFF', cursor: 'pointer' },
      statusBanner: { display: 'flex', alignItems: 'center', gap: '10px', padding: '16px 20px', borderRadius: '12px', fontSize: '14px', fontWeight: '500' },
      statusDot: { width: '8px', height: '8px', borderRadius: '50%' },
      scoreInfoCard: { padding: '16px 20px', backgroundColor: '#FFF8DC', borderRadius: '12px', marginBottom: '24px', fontSize: '14px', color: '#8B6914' },
      scoresSection: { marginTop: '24px' },
      scoresSectionHeader: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' },
      scoreCount: { fontSize: '14px', fontWeight: '500', color: '#666' },
      pdfExportBtn: { padding: '10px 20px', border: '1px solid #3182F6', backgroundColor: '#E8F3FF', borderRadius: '10px', fontSize: '14px', fontWeight: '600', color: '#3182F6', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '6px' },
      headerButtons: { display: 'flex', gap: '10px' },
      copyBtn: { padding: '10px 20px', border: '1px solid #00C471', backgroundColor: '#E8FFF3', borderRadius: '10px', fontSize: '14px', fontWeight: '600', color: '#00C471', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '6px' },
      emptyState: { backgroundColor: '#FFF', borderRadius: '16px', padding: '64px', textAlign: 'center', boxShadow: '0 2px 10px rgba(0,0,0,0.05)', color: '#999' },
      scoresList: { display: 'flex', flexDirection: 'column', gap: '12px' },
      scoreCard: { display: 'flex', alignItems: 'center', gap: '16px', padding: '20px', backgroundColor: '#FFF', borderRadius: '12px', boxShadow: '0 2px 10px rgba(0,0,0,0.05)', cursor: 'pointer' },
      scoreRank: { width: '32px', textAlign: 'center' },
      rankBadge: { width: '28px', height: '28px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '14px', fontWeight: '700', color: '#FFF' },
      rankNumber: { fontSize: '16px', fontWeight: '600', color: '#999' },
      scoreAvatar: { width: '44px', height: '44px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#FFF', fontSize: '16px', fontWeight: '600' },
      scoreInfo: { flex: 1 },
      scoreName: { fontSize: '16px', fontWeight: '600', color: '#191F28' },
      scoreTeam: { fontSize: '13px', color: '#666' },
      scoreVoters: { padding: '6px 12px', backgroundColor: '#F7F8FA', borderRadius: '6px', fontSize: '13px', color: '#666' },
      scoreTotalValue: { textAlign: 'right', minWidth: '80px' },
      scoreNumber: { fontSize: '24px', fontWeight: '700', color: '#3182F6' },
      scoreUnit: { fontSize: '14px', color: '#666', marginLeft: '2px' },
      detailArrow: { fontSize: '16px', color: '#CCC' },
      modalAvatar: { width: '32px', height: '32px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#FFF', fontSize: '14px', fontWeight: '600' },
      voterList: { display: 'flex', flexDirection: 'column', gap: '12px', marginTop: '20px' },
      voterItem: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '16px', backgroundColor: '#F7F8FA', borderRadius: '12px' },
      voterInfo: { display: 'flex', alignItems: 'center', gap: '12px' },
      voterAvatar: { width: '40px', height: '40px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#FFF', fontSize: '14px', fontWeight: '600' },
      voterName: { fontSize: '15px', fontWeight: '600', color: '#191F28', display: 'flex', alignItems: 'center', gap: '6px' },
      voterTeam: { fontSize: '13px', color: '#666' },
      ceoBadgeSmall: { padding: '2px 6px', backgroundColor: '#FFE066', borderRadius: '4px', fontSize: '11px', fontWeight: '700', color: '#8B6914' },
      voterScoreBox: { textAlign: 'right' },
      voterScore: { fontSize: '20px', fontWeight: '700', color: '#3182F6' },
      voterScoreUnit: { fontSize: '13px', color: '#666', marginLeft: '2px' },
      totalSummary: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '16px 20px', backgroundColor: '#E8F3FF', borderRadius: '12px', marginTop: '16px', fontSize: '15px', fontWeight: '600', color: '#3182F6' },
      totalSummaryValue: { fontSize: '20px', fontWeight: '700' },
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
